Authors have satisfactorily addressed most of my questions and comments. However, I still have two main concerns (see follow up on Questions 12/13 and 19) and other minor comments. Follow up on Q12/Q13: Dimensionality reduction approaches like PCA are exploratory techniques suitable to be used at early stages of the analysis. Of course they may be affected by increasing levels of noise, but still have proved valuable to uncover the underlying structure of high-dimensional transcriptional data without feature selection steps. The potential benefit of a particular feature selection approach preceding them is something that can -and should- be checked by the user by comparing the results obtained before and after the filtering steps. There is no reason to overlook the "unfiltered" results, as ignoring them a priori could neglect important factors. While restricting the analysis to correlated HVGs can enhance the signal of the most prominent differences (e.g. main subgroups or trends), the approach risks to filter out important genes for the identification of e.g. small subpopulations of cells and/or further heterogeneity within a given group, which are main motivations of many single-cell studies. The following code illustrates that the assessment of correlated genes used here (correlatePairs function) presents drawbacks (e.g. correlation results are sensitive to the relative size of the different subpopulations of cells and to random noise). Restricting the analysis to correlated HVGs could eventually limit the ability to capture the structure of the data and, in opinion of this referee, the general recommendation to the reader should be to apply the filter after checking that no obvious things are missed The example shows 3 subpopulations of cells determined by 2 markers (gene 1 and 2) (a common case, for instance, in immunology): -/-, +/- and -/+ . In the example, another two genes are tightly associated with the previous markers (gene 3 and 4, respectively). By themselves, gene 3 and 4 would determine as well the 3 populations. Two scenarios are illustrated. First 3 subpopulations of equal size, and second 3 populations of uneven size, with a subpopulation of cells of small size set.seed(100) # Scenario A: 3 subpopulations of equal size Size1-333 Size2-333 Size3-333 myvar=1 NEG_NEG-cbind(rnorm(Size1,100,myvar),rnorm(Size1,100,myvar),rnorm(Size1,100,myvar),rnorm(Size1,100,myvar)) POS_NEG-cbind(rnorm(Size2,200,myvar),rnorm(Size2,100,myvar),rnorm(Size2,200,myvar),rnorm(Size2,100,myvar)) NEG_POS-cbind(rnorm(Size3,100,myvar),rnorm(Size3,200,myvar),rnorm(Size3,100,myvar),rnorm(Size3,200,myvar)) M-as.matrix(rbind(NEG_NEG,POS_NEG,NEG_POS)) var.cor - correlatePairs(t(M)) subset(var.cor,FDR = 0.05) gene1 gene2 rho p.value FDR 1 1 3 0.6770746 1.999998e-06 1.999998e-06 2 2 4 0.6680684 1.999998e-06 1.999998e-06 3 3 4 -0.3477739 1.999998e-06 1.999998e-06 4 2 3 -0.3477432 1.999998e-06 1.999998e-06 5 1 4 -0.3462825 1.999998e-06 1.999998e-06 6 1 2 -0.3168503 1.999998e-06 1.999998e-06 dim(M) [1] 999 4 M2 - cbind(M, matrix(rnorm((Size1+Size2+Size3)*1000), ncol=1000)) # Adding uncorrelated noise dim(M2) [1] 999 1004 PCM-prcomp(M2) plot(PCM$x[,1],PCM$x[,2], pch=16) cor(M,method="spearman") [,1] [,2] [,3] [,4] [1,] 1.0000000 -0.3168503 0.6770746 -0.3462825 [2,] -0.3168503 1.0000000 -0.3477432 0.6680684 [3,] 0.6770746 -0.3477432 1.0000000 -0.3477739 [4,] -0.3462825 0.6680684 -0.3477739 1.0000000 cor(PCM$x[,1],M) [,1] [,2] [,3] [,4] [1,] 0.8655852 -0.8660004 0.8659075 -0.8663694 cor(PCM$x[,2],M) [,1] [,2] [,3] [,4] [1,] 0.5005309 0.4998326 0.4999728 0.4991926 # Scenario B: 3 subpopulations of uneven size Size1-800 Size2-185 Size3-15 myvar=.1 NEG_NEG-cbind(rnorm(Size1,100,myvar),rnorm(Size1,100,myvar),rnorm(Size1,100,myvar),rnorm(Size1,100,myvar)) POS_NEG-cbind(rnorm(Size2,200,myvar),rnorm(Size2,100,myvar),rnorm(Size2,200,myvar),rnorm(Size2,100,myvar)) NEG_POS-cbind(rnorm(Size3,100,myvar),rnorm(Size3,200,myvar),rnorm(Size3,100,myvar),rnorm(Size3,200,myvar)) M-as.matrix(rbind(NEG_NEG,POS_NEG,NEG_POS)) var.cor - correlatePairs(t(M)) subset(var.cor,FDR = 0.05) gene1 gene2 rho p.value FDR 1 1 3 0.4423758 1.999998e-06 1.199999e-05 dim(M) [1] 1000 4 M2 - cbind(M, matrix(rnorm((Size1+Size2+Size3)*1000), ncol=1000)) # Adding uncorrelated noise dim(M2) [1] 1000 1004 PCM-prcomp(M2) plot(PCM$x[,1],PCM$x[,2], pch=16) cor(M,method="spearman") [,1] [,2] [,3] [,4] [1,] 1.00000000 -0.04622429 0.44237576 -0.02078442 [2,] -0.04622429 1.00000000 -0.02955135 0.01551650 [3,] 0.44237576 -0.02955135 1.00000000 -0.02922687 [4,] -0.02078442 0.01551650 -0.02922687 1.00000000 cor(PCM$x[,1],M) [,1] [,2] [,3] [,4] [1,] -0.9999771 0.06552188 -0.9999781 0.06533876 cor(PCM$x[,2],M) [,1] [,2] [,3] [,4] [1,] -0.006496133 -0.9978253 -0.006326823 -0.9978401 In the first scenario, the correlatePairs function leads to significant results among all pair-wise comparisons. However, in the second scenario, filtering through the correlatePairs function will miss the association between 2-4, as well as the antagonism between (1+, 3+) versus (2+, 4+). In both scenarios, a PCA analysis would have detected both factors and the 3 underlying subpopulations, despite the presence of uncorrelated noise. Q19 The inspection of the similarity between the quickCluster results and the dendrograms is not suggested as an indication of performance but, eventually, suitable to avoid circularity. I wonder whether, if some groups from the quickCluster were largely equivalent to groups resulting from the dendogram, the differentially expressed genes detected among them could just be reflecting the different size factors applied to each group at the normalization step rather than true biological differences in their expression levels Minor comments: Q5 The approach of Shalek et al. was not suggested by this referee here as an alternative way to filter out genes. On the contrary, it was proposed as a way to retain genes that eventually could be filtered out by the "non-zero counts in at least n cells" criteria. For instance, following such a simple rule, a gene expressed with high levels in few cells (i.e. eventually departing from expectations) will be treated the same way as a gene lowly expressed in few cells (following noise expectations). As authors already warned in the text, the risk is neglecting important genes for the identification of rare subpopulations of cells. Q15 Heatmaps are typically used to visualize both clustering of cells and of genes. Being Spearman's correlation the method of choice to assess correlated HVGs, and being correlated HVGs the set of genes on which clustering of cells is represented, it seems to this referee more consistent to use Spearman's rho as the default distance of choice to determine the ordering of genes in the plot. As for the clustering of cells, the statement "in the context of this workflow, the differences in clustering on correlations versus Euclidean distances would only have a minor effect" could eventually not hold true and, in any case, can be easily checked by the user Q18 The inspection of the distribution of the percentage of variance explained by the different PCs is not suggested here to assist interpretation of the non-visualized components. On the contrary, it is necessary to avoid an over-interpretation (or oversimplification) of a visualization done on the first 2 dimensions, when additional dimensions could still gather a high % of variance relevant to interpret the structure of the data. Literature exists on how to determine the "relevant" number of dimensions, and hence, whether visualization on 2D is any useful. 