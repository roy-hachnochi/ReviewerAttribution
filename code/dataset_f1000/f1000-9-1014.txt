

    <!DOCTYPE html>
<html class="">

        
<head>
    <title>Spatial mapping of single cells in the Drosophila... | F1000Research</title>
    <meta charset="utf-8">
    <!--<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>-->
    <!--<meta lang="$locale">-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="9-QVycOO2_ob3Z9QzRmXv2CF08A9oyYXqWyTiVdKPlU" />
    <!-- This is commented out to fix display problems on mobile devices.
    We may use it again once we implement a responsive design that supports native device resolutions.
    <meta name="viewport" content="width=device-width"> -->

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <link rel="alternate" title="Recent articles published in F1000Research" href="/rss" type="application/rss+xml">
            <link rel="alternate" type="application/pdf" title="PDF" href="https://f1000research.com/articles/9-1014/pdf"/>
        <link rel="canonical" href="https://f1000research.com/articles/9-1014" />
    
            <meta name="description" content="Read the original article in full on F1000Research: Spatial mapping of single cells in the Drosophila embryo from transcriptomic data based on topological consistency" />
    
            <meta name="og:title" content="F1000Research Article: Spatial mapping of single cells in the &lt;i&gt;Drosophila&lt;/i&gt; embryo from transcriptomic data based on topological consistency.">
            <meta name="og:description" content="Read the latest article version by Maryam Zand, Jianhua Ruan, at F1000Research.">
            <meta name="og:image" content="/img/sharing/og_research.png">
            <meta name="version-id" content="26653">
            <meta name="article-id" content="24163">
            <meta name="dc.title" content="Spatial mapping of single cells in the &lt;i&gt;Drosophila&lt;/i&gt; embryo from transcriptomic data based on topological consistency">
            <meta name="dc.description" content="The advancement in single-cell RNA sequencing technologies allow us to obtain transcriptome at single cell resolution. However, the original spatial context of cells, a crucial knowledge for understanding cellular and tissue-level functions, is often lost during sequencing. To address this issue, the DREAM Single Cell Transcriptomics Challenge launched a community-wide effort to seek computational solutions for spatial mapping of single cells in tissues using single-cell RNAseq (scRNA-seq) data and a reference atlas obtained from in situ hybridization data. As a top-performing team in this competition, we approach this problem in three steps. The first step involves identifying a set of most informative genes based on the consistency between gene expression similarity and cell proximity. For this step, we propose two different approaches, i.e., an unsupervised approach that does not utilize the gold standard location of the cells provided by the challenge organizers, and a supervised approach that relies on the gold standard locations. In the second step, a Particle Swarm Optimization algorithm is used to optimize the weights of different genes in order to maximize matches between the predicted locations and the gold standard locations. Finally, the information embedded in the cell topology is used to improve the predicted cell-location scores by weighted averaging of scores from neighboring locations. Evaluation results based on DREAM scores show that our method accurately predicts the location of single cells, and the predictions lead to successful recovery of the spatial expression patterns for most of landmark genes. In addition, investigating the selected genes demonstrates that most predictive genes are cluster specific, and stable across our supervised and unsupervised gene selection frameworks. Overall, the promising results obtained by our methods in DREAM challenge demonstrated that topological consistency is a useful concept in identifying marker genes and constructing predictive models for spatial mapping of single cells.">
            <meta name="dc.subject" content="Single cell RNA-seq, spatial mapping, feature selection, particle swarm intelligence, nearest neighbor">
            <meta name="dc.creator" content="Zand, Maryam">
            <meta name="dc.creator" content="Ruan, Jianhua">
            <meta name="dc.date" content="2020/08/20">
            <meta name="dc.identifier" content="doi:10.12688/f1000research.24163.1">
            <meta name="dc.source" content="F1000Research 2020 9:1014">
            <meta name="dc.format" content="text/html">
            <meta name="dc.language" content="en">
            <meta name="dc.publisher" content="F1000 Research Limited">
            <meta name="dc.rights" content="https://creativecommons.org/licenses/by/3.0/igo/">
            <meta name="dc.type" content="text">
            <meta name="prism.keyword" content="Single cell RNA-seq">
            <meta name="prism.keyword" content="spatial mapping">
            <meta name="prism.keyword" content="feature selection">
            <meta name="prism.keyword" content="particle swarm intelligence">
            <meta name="prism.keyword" content="nearest neighbor">
            <meta name="prism.publication.Name" content="F1000Research">
            <meta name="prism.publicationDate" content="2020/08/20">
            <meta name="prism.volume" content="9">
            <meta name="prism.number" content="1014">
            <meta name="prism.versionIdentifier" content="1">
            <meta name="prism.doi" content="10.12688/f1000research.24163.1">
            <meta name="prism.url" content="https://f1000research.com/articles/9-1014">
            <meta name="citation_title" content="Spatial mapping of single cells in the &lt;i&gt;Drosophila&lt;/i&gt; embryo from transcriptomic data based on topological consistency">
            <meta name="citation_abstract" content="The advancement in single-cell RNA sequencing technologies allow us to obtain transcriptome at single cell resolution. However, the original spatial context of cells, a crucial knowledge for understanding cellular and tissue-level functions, is often lost during sequencing. To address this issue, the DREAM Single Cell Transcriptomics Challenge launched a community-wide effort to seek computational solutions for spatial mapping of single cells in tissues using single-cell RNAseq (scRNA-seq) data and a reference atlas obtained from in situ hybridization data. As a top-performing team in this competition, we approach this problem in three steps. The first step involves identifying a set of most informative genes based on the consistency between gene expression similarity and cell proximity. For this step, we propose two different approaches, i.e., an unsupervised approach that does not utilize the gold standard location of the cells provided by the challenge organizers, and a supervised approach that relies on the gold standard locations. In the second step, a Particle Swarm Optimization algorithm is used to optimize the weights of different genes in order to maximize matches between the predicted locations and the gold standard locations. Finally, the information embedded in the cell topology is used to improve the predicted cell-location scores by weighted averaging of scores from neighboring locations. Evaluation results based on DREAM scores show that our method accurately predicts the location of single cells, and the predictions lead to successful recovery of the spatial expression patterns for most of landmark genes. In addition, investigating the selected genes demonstrates that most predictive genes are cluster specific, and stable across our supervised and unsupervised gene selection frameworks. Overall, the promising results obtained by our methods in DREAM challenge demonstrated that topological consistency is a useful concept in identifying marker genes and constructing predictive models for spatial mapping of single cells.">
            <meta name="citation_description" content="The advancement in single-cell RNA sequencing technologies allow us to obtain transcriptome at single cell resolution. However, the original spatial context of cells, a crucial knowledge for understanding cellular and tissue-level functions, is often lost during sequencing. To address this issue, the DREAM Single Cell Transcriptomics Challenge launched a community-wide effort to seek computational solutions for spatial mapping of single cells in tissues using single-cell RNAseq (scRNA-seq) data and a reference atlas obtained from in situ hybridization data. As a top-performing team in this competition, we approach this problem in three steps. The first step involves identifying a set of most informative genes based on the consistency between gene expression similarity and cell proximity. For this step, we propose two different approaches, i.e., an unsupervised approach that does not utilize the gold standard location of the cells provided by the challenge organizers, and a supervised approach that relies on the gold standard locations. In the second step, a Particle Swarm Optimization algorithm is used to optimize the weights of different genes in order to maximize matches between the predicted locations and the gold standard locations. Finally, the information embedded in the cell topology is used to improve the predicted cell-location scores by weighted averaging of scores from neighboring locations. Evaluation results based on DREAM scores show that our method accurately predicts the location of single cells, and the predictions lead to successful recovery of the spatial expression patterns for most of landmark genes. In addition, investigating the selected genes demonstrates that most predictive genes are cluster specific, and stable across our supervised and unsupervised gene selection frameworks. Overall, the promising results obtained by our methods in DREAM challenge demonstrated that topological consistency is a useful concept in identifying marker genes and constructing predictive models for spatial mapping of single cells.">
            <meta name="citation_keywords" content="Single cell RNA-seq, spatial mapping, feature selection, particle swarm intelligence, nearest neighbor">
            <meta name="citation_journal_title" content="F1000Research">
            <meta name="citation_author" content="Maryam Zand">
            <meta name="citation_author_institution" content="Computer science, University of Texas at San Antonio, San Antonio, Texas, 78249, USA">
            <meta name="citation_author" content="Jianhua Ruan">
            <meta name="citation_author_institution" content="Computer science, University of Texas at San Antonio, San Antonio, Texas, 78249, USA">
            <meta name="citation_publication_date" content="2020/08/20">
            <meta name="citation_volume" content="9">
            <meta name="citation_publication_number" content="1014">
            <meta name="citation_version_number" content="1">
            <meta name="citation_doi" content="10.12688/f1000research.24163.1">
            <meta name="citation_firstpage" content="1014">
            <meta name="citation_pdf_url" content="https://f1000research.com/articles/9-1014/v1/pdf">
    

    
    <link href="/img/favicon-research.ico" rel="shortcut icon" type="image/ico">
    <link href="/img/favicon-research.ico" rel="icon" type="image/ico">

        <link rel="stylesheet" href="/1597255280893/css/mdl/material-design-lite.css" type="text/css" media="all" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/2.2.43/css/materialdesignicons.min.css" />

        
            
    <link rel="stylesheet" href="/1597255280893/css/F1000Research.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/css/F1000ResearchFontIcons/F1000ResearchFontIcons.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/css/F1000ResearchFontIcons/animation.css" type="text/css" media="all" />

        <!--[if IE 7]><link rel="stylesheet" href="/css/F1000ResearchFontIcons/F1000ResearchFontIcons-ie7.css" media="all" /><![endif]-->

                    <script>dataLayer = [];</script>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-54Z2SBK');</script>
        <!-- End Google Tag Manager -->
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery-1.8.1.min.js"><\/script>')</script>
    <script src="/1597255280893/js/vendor/modernizr-2.6.1-respond-1.1.0.min.js"></script>
    <script src="/1597255280893/js/shared_scripts/sticky.js"></script>
    <script src="/1597255280893/js/shared_scripts/helpers.js"></script>
    <script src="/1597255280893/js/shared_scripts/menu.js"></script>
    <script src="/1597255280893/js/shared_scripts/navbar.js"></script>
    <script src="/1597255280893/js/shared_scripts/platforms.js"></script>
    <script src="/1597255280893/js/shared_scripts/object-polyfills.js"></script>
            <script src="/1597255280893/js/vendor/lodash.min.js"></script>
        <script>CKEDITOR_BASEPATH='https://f1000research.com/js/ckeditor/'</script>
    <script src="https://f1000researchdata.s3-eu-west-1.amazonaws.com/js/plugins.js"></script>
    <script src="/1597255280893/js/shared_scripts/helpers.js"></script>
    <script src="/1597255280893/js/app/research.js"></script>
    <script>window.reactTheme = 'research';</script>
    <script src="/1597255280893/js/public/bundle.js"></script>

    <script src="/1597255280893/js/app/research.ui.js"></script>
    <script src="/1597255280893/js/app/login.js"></script>
    <script src="/1597255280893/js/app/main.js"></script>
    <script src="/1597255280893/js/app/js-date-format.min.js"></script>
    <script src="/1597255280893/js/app/search.js"></script>
    <script src="/1597255280893/js/app/cookies_warning.js"></script>
    <script src="/1597255280893/js/mdl/mdl.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
                <script src="https://f1000researchdata.s3-eu-west-1.amazonaws.com/js/ckeditor.js"></script>
            <script src="/js/ckeditor/adapters/jquery.js"></script>
                <script src="/js/article/article_scrolling_module.js"></script>
            <script src="/js/article/article_stats.js"></script>
            <script src="/js/article/article.js"></script>
            <script src="/js/shared_scripts/referee_timeline_pagination.js"></script>
            <script src="/js/app/text_editor_controller.js"></script>
            <script src="//s7.addthis.com/js/250/addthis_widget.js#pubid=ra-503e5e99593dc42c"></script>
            <script src="/js/article/article_metrics.js"></script>
        
                                                                            <script>
            if (window.location.hash == '#_=_'){
                window.location = window.location.href.split('#')[0]
            }
        </script>

                    
        
    <!-- pixelId: 1641728616063202 :: assetPixelId: 6034867600215 :: funderPixelId:  -->

            <!-- Facebook pixel code (merged with EP GTM code) -->
        <script>
            !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function()

            {n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments)}
            ;if(!f._fbq)f._fbq=n;
            n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
            document,'script','https://connect.facebook.net/en_US/fbevents.js');

            fbq('init', '1641728616063202');

            
            fbq('track', "PixelInitialized", {});
        </script>

        <noscript><img height="1" width="1" style="display:none"
            src="https://www.facebook.com/tr?id=1641728616063202&noscript=1&amp;ev=PixelInitialized"
        /></noscript>
        <!-- End Facebook Pixel Code -->
    
                <script>
            (function(h,o,t,j,a,r){
                h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
                h._hjSettings={hjid:917825,hjsv:6};
                a=o.getElementsByTagName('head')[0];
                r=o.createElement('script');r.async=1;
                r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
                a.appendChild(r);
            })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
        </script>
    
</head>
<body  class="o-page-container no-js p-article o-layout-reset   ">

    
                            <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-54Z2SBK"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
    
        
    <div class="o-page">

        <div id="notify-container"></div>
        <div id="pageWarning"></div>
        <div id="pageMessage"></div>
        <div id="pageFooterMessage"></div>

                                <div id="f1r-ga-data" data-name="f1r-ga-data" class="f1r-ga-data"
                data-user-registered="false"
                data-user-module=""
                data-current-path=""
                data-location=""
                data-website="F1000Research"
                data-websiteDisplayName="F1000Research">
            </div>
        
                
        
        <div class="header-wrapper   js-navbar-space ">
                            


    










        
                            
    
            



<nav class="c-navbar js-navbar js-mini-nav js-sticky c-navbar--js-sticky c-navbar--userSite c-navbar__platform-bgcolor  c-navbar--bg-f1000research ">

    <div class="c-navbar__content">

                                <div class="c-navbar__extras">
            <div class="o-wrapper">
                <div class="o-actions o-actions--middle c-navbar__extras-row">
                    <div class="o-actions__primary">
                        
                                            </div>
                                    </div>
            </div>
        </div>

        <div class="o-wrapper t-inverted js-sticky-start">

            <div class="c-navbar__branding-row">
                <div class="c-navbar__row">


                                        
                    <div class="c-navbar__primary u-mr--2">

                                                                                                                                                                                                    <a href="/" class="c-navbar__branding u-ib u-middle"   data-test-id="nav_branding"  >
                                <img class="u-ib u-middle" src="/img/research/F1000Research_white_solid.svg" alt="F1000Research">
                            </a>
                                            </div>

                    <div class="c-navbar__secondary c-navbar__row">


                                                
                                                    <form action="/search" class="-navbar__secondary u-mr--2 c-search-form js-search-form u-hide u-show@navbar">
                                <label for="searchInput" class="c-search-form__label _mdl-layout">
                                    <input name="q" type="search" class="c-search-form__input" id="searchInput" placeholder="Search">
                                    <button type="submit" class="c-search-form__submit mdl-button mdl-js-button mdl-button--icon"><i class="material-icons">search</i></button>
                                </label>
                            </form>
                        
                                                
                                                    <div class="c-navbar__primary u-hide u-show@navbar">
                                <div class="_mdl-layout c-navbar__cta">
                                    <a class="mdl-button mdl-js-button mdl-button--raised mdl-button--no-shadow mdl-button--multi-line mdl-js-ripple-effect mdl-button--inverted c-navbar__submit" href="/for-authors/publish-your-research"   data-test-id="nav_submit_research"  ><i class="material-icons">file_upload</i>Submit your research</a>
                                </div>
                            </div>
                        

                                                
                        <span class="u-hide@navbar _mdl-layout u-nowrap">

                                                            <button type="button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon c-navbar__toggle c-navbar__toggle--menu js-navbar-toggle" data-focus="#navbar_mob_search_input" data-toggle="navbarMenu" data-target="navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation"   data-test-id="nav_menu_search_mob"  ><i class="material-icons">search</i></button>
                            
                                                            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-button--multi-line c-navbar__toggle c-navbar__toggle--menu js-navbar-toggle" type="button" data-toggle="navbarMenu" data-target="navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation"   data-test-id="nav_menu_toggle_mob"  >
                                    <i class="material-icons c-navbar__toggle-open">menu</i>
                                    <i class="material-icons c-navbar__toggle-close">close</i>
                                </button>
                                                    </span>
                    </div>

                </div>
            </div>

                        
                            <div class="c-navbar__menu-row js-navbar-block is-collapsed" id="navbarMenu">

                                                                                                                                                
                                                                    
                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                            

                                                                
                                                                                                                                                                                                                                
                                            
                    <div class="c-navbar__menu-row-content">

                                                                            <div class="u-hide@navbar c-navbar__menu-bar-spacing">
                                <form action="/search" class="c-search-form js-search-form">
                                    <label for="navbar_mob_search_input" class="c-search-form__label _mdl-layout">
                                        <input id="navbar_mob_search_input" name="q" type="search" class="c-search-form__input" placeholder="Search">
                                        <button type="submit" class="c-search-form__submit mdl-button mdl-js-button mdl-button--icon"><i class="material-icons">search</i></button>
                                    </label>
                                </form>
                            </div>
                        
                        <div class="o-actions o-actions--middle">

                            <div class="o-actions__primary">

                                                                
    <ul class="c-menubar c-navbar__menu-bar js-main-menu"   id="main-menu"   role="menubar" aria-label="Main Navigation"  data-menu-group="navbar" >

        
            
                                                                
                                
                                
                                    <li role="none"
                        data-index="0"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                              ">

                        <a href="/browse/articles" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                                                    tabindex="0"
                              data-test-id="nav_browse"                              >Browse</a>

                                            </li>
                
            
        
            
                                                                
                
                                
                                    <li role="none"
                        data-index="1"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                              ">

                        <a href="/gateways" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                                                    tabindex="-1"
                              data-test-id="nav_gatewaysViewAndBrowse"                              >Gateways & Collections</a>

                                            </li>
                
            
        
            
                                                                
                
                                
                                    <li role="none"
                        data-index="2"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                               c-menubar__item--selected c-navbar__menu-bar-item--parent ">

                        <a href="#" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                         aria-haspopup="true" aria-expanded="false"                             tabindex="-1"
                              data-test-id="nav_for-authors"                              >How to Publish</a>

                                                    
    <ul class="c-menu js-menu
                is-collapsed                c-menubar__menu c-navbar__menu"
                  role="menu"
        aria-label="How to Publish">

        
            
                                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_submit-manuscript"                      href="/for-authors/publish-your-research"
                    role="menuitem"
                    tabindex="0">Submit your Research</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_my-submissions"                      href="/for-authors/my-submissions"
                    role="menuitem"
                    tabindex="-1">My Submissions</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_article-guidelines"                      href="/for-authors/article-guidelines"
                    role="menuitem"
                    tabindex="-1">Article Guidelines</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_article-guidelines-new-versions"                      href="/for-authors/article-guidelines-new-versions"
                    role="menuitem"
                    tabindex="-1">Article Guidelines (New Versions)</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_data-guidelines"                      href="/for-authors/data-guidelines"
                    role="menuitem"
                    tabindex="-1">Data Guidelines</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_asset-guidelines"                      href="/for-authors/posters-and-slides-guidelines"
                    role="menuitem"
                    tabindex="-1">Posters and Slides Guidelines</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_document-guidelines"                      href="/for-authors/document-guidelines"
                    role="menuitem"
                    tabindex="-1">Document Guidelines</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_article-processing-charges"                      href="/for-authors/article-processing-charges"
                    role="menuitem"
                    tabindex="-1">Article Processing Charges</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_finding-referees"                      href="/for-authors/tips-for-finding-referees"
                    role="menuitem"
                    tabindex="-1">Finding Article Reviewers</a>

                </li>

                        </ul>
                                            </li>
                
            
        
            
                                                                
                
                                
                                    <li role="none"
                        data-index="3"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                               c-menubar__item--selected c-navbar__menu-bar-item--parent ">

                        <a href="#" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                         aria-haspopup="true" aria-expanded="false"                             tabindex="-1"
                              data-test-id="nav_about-contact"                              >About</a>

                                                    
    <ul class="c-menu js-menu
                is-collapsed                c-menubar__menu c-navbar__menu"
                  role="menu"
        aria-label="About">

        
            
                                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_about-page"                      href="/about"
                    role="menuitem"
                    tabindex="0">How it Works</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_referee-guidelines"                      href="/for-referees/guidelines"
                    role="menuitem"
                    tabindex="-1">For Reviewers</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_advisoryPanel"                      href="/advisors"
                    role="menuitem"
                    tabindex="-1">Our Advisors</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_policy-page"                      href="/about/policies"
                    role="menuitem"
                    tabindex="-1">Policies</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_glossary-page"                      href="/glossary"
                    role="menuitem"
                    tabindex="-1">Glossary</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_faqs-page"                      href="/faqs"
                    role="menuitem"
                    tabindex="-1">FAQs</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              u-hide u-show@navbar"
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      u-hide u-show@navbar"
                                          data-test-id="nav_for-developers"                      href="/developers"
                    role="menuitem"
                    tabindex="-1">For Developers</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_newsroom-page"                      href="/newsroom"
                    role="menuitem"
                    tabindex="-1">Newsroom</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_contact-page"                      href="/contact"
                    role="menuitem"
                    tabindex="-1">Contact</a>

                </li>

                        </ul>
                                            </li>
                
            
        
            
                                                                
                
                                
                                    <li role="none"
                        data-index="4"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                              ">

                        <a href="https://blog.f1000.com/blogs/f1000research/" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                             target="_blank"                                                         tabindex="-1"
                              data-test-id="nav_blog"                              >Blog</a>

                                            </li>
                
            
        
    </ul>



                            </div>

                            <div class="o-actions__secondary">

                                                                
    <ul class="c-menubar c-navbar__menu-bar js-main-menu"   id="secondary-items"   role="menubar" aria-label="My Account"  data-menu-group="navbar" >

        
            
                                                                
                                
                                
                                    <li role="none"
                        data-index="0"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                               c-menubar__item--selected c-navbar__menu-bar-item--parent ">

                        <a href="#" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                         aria-haspopup="true" aria-expanded="false"                             tabindex="0"
                              data-test-id="nav_my-research"                              >My Research</a>

                                                    
    <ul class="c-menu js-menu
                is-collapsed                c-menubar__menu c-navbar__menu"
                  role="menu"
        aria-label="My Research">

        
            
                                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_my-submissions"                      href="/login?originalPath=/my/submissions"
                    role="menuitem"
                    tabindex="0">Submissions</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_my-email-alerts"                      href="/login?originalPath=/my/email-alerts"
                    role="menuitem"
                    tabindex="-1">Content and Tracking Alerts</a>

                </li>

                    
            
                
                                
                <li class="c-menu__item js-menu-item
                                              "
                        role="none">

                <a  class="c-menu__link js-menu-link
                                                      "
                                          data-test-id="nav_my-user-details"                      href="/login?originalPath=/my/user-details"
                    role="menuitem"
                    tabindex="-1">My Details</a>

                </li>

                        </ul>
                                            </li>
                
            
        
            
                                                                
                
                                
                                    <li role="none"
                        data-index="1"
                        class="c-menubar__item js-menu-item  c-navbar__menu-bar-item
                                                              ">

                        <a href="/login?originalPath=/articles/9-1014.html" class="c-navbar__menu-bar-link js-menu-link " role="menuitem"
                                                                                    tabindex="-1"
                              data-test-id="nav_sign-in"                              >Sign In</a>

                                            </li>
                
            
        
    </ul>



                            </div>

                                                                                        <div class="_mdl-layout c-navbar__cta u-hide@navbar c-navbar__menu-bar-spacing">
                                    <a class="mdl-button mdl-js-button mdl-button--raised mdl-button--multi-line mdl-button--no-shadow mdl-js-ripple-effect mdl-button--inverted c-navbar__submit" href="/for-authors/publish-your-research"   data-test-id="nav_submit_research_mob"  ><i class="material-icons">file_upload</i>Submit your research</a>
                                </div>
                                                    </div>

                    </div>

                </div>
            
        </div>

    </div>

</nav>
                    </div>

        <div class="content-wrapper o-page__main row ">
            <div id="highlight-area" class="content ">
                





<div id=article-metadata class=hidden> <input type=hidden name=versionId value=26653 /> <input type=hidden id=articleId name=articleId value=24163 /> <input type=hidden id=xmlUrl value="/articles/9-1014/v1/xml"/> <input type=hidden id=xmlFileName value="-9-1014-v1.xml"> <input type=hidden id=article_uuid value=b1043569-6e44-43a5-8d67-9424018193c6 /> <input type=hidden id=referer value=""/> <input type="hidden" id="meta-article-title" value="Spatial mapping of single cells in the <i>Drosophila</i> embryo from transcriptomic data based on topological consistency" /> <input type=hidden id=workspace-export-url value="https://sciwheel.com/work/api/import/external?doi=10.12688/f1000research.24163.1"/> <input type=hidden id=versionDoi value="10.12688/f1000research.24163.1"/> <input type=hidden id=usePmcStats value=true /> </div> <main class="o-wrapper p-article__wrapper js-wrapper"> <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ScholarlyArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://f1000research.com/articles/9-1014"
  },
  "headline": "Spatial mapping of single cells in the Drosophila embryo from transcriptomic data based on topological...",
  "datePublished": "2020-08-20T15:52:25",
  "dateModified": "2020-08-20T15:52:25",
  "author": [
    {
      "@type": "Person",
      "name": "Maryam Zand"
    },    {
      "@type": "Person",
      "name": "Jianhua Ruan"
    }  ],
  "publisher": {
    "@type": "Organization",
    "name": "F1000Research",
    "logo": {
      "@type": "ImageObject",
      "url": "https://f1000research.com/img/AMP/F1000Research_image.png",
      "height": 480,
      "width": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://f1000research.com/img/AMP/F1000Research_image.png",
    "height": 1200,
    "width": 150
  },
  "description": "The advancement in single-cell RNA sequencing technologies allow us to obtain transcriptome at single cell resolution. However, the original spatial context of cells, a crucial knowledge for understanding cellular and tissue-level functions, is often lost during sequencing. To address this issue, the DREAM Single Cell Transcriptomics Challenge launched a community-wide effort to seek computational solutions for spatial mapping of single cells in tissues using single-cell RNAseq (scRNA-seq) data and a reference atlas obtained from in situ hybridization data. As a top-performing team in this competition, we approach this problem in three steps. The first step involves identifying a set of most informative genes based on the consistency between gene expression similarity and cell proximity. For this step, we propose two different approaches, i.e., an unsupervised approach that does not utilize the gold standard location of the cells provided by the challenge organizers, and a supervised approach that relies on the gold standard locations. In the second step, a Particle Swarm Optimization algorithm is used to optimize the weights of different genes in order to maximize matches between the predicted locations and the gold standard locations. Finally, the information embedded in the cell topology is used to improve the predicted cell-location scores by weighted averaging of scores from neighboring locations. Evaluation results based on DREAM scores show that our method accurately predicts the location of single cells, and the predictions lead to successful recovery of the spatial expression patterns for most of landmark genes. In addition, investigating the selected genes demonstrates that most predictive genes are cluster specific, and stable across our supervised and unsupervised gene selection frameworks. Overall, the promising results obtained by our methods in DREAM challenge demonstrated that topological consistency is a useful concept in identifying marker genes and constructing predictive models for spatial mapping of single cells."
}
</script> <div class="o-layout o-layout--right-gutter"> <div id=article_secondary-column class="p-article__main o-layout__item u-font-size--legal u-2/3@article not-expanded "> <div class=float-left> <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
              {
          "@type": "ListItem",
          "position": "1",
          "item": {
            "@id": "https://f1000research.com/",
            "name": "Home"
          }
        },              {
          "@type": "ListItem",
          "position": "2",
          "item": {
            "@id": "https://f1000research.com/browse/articles",
            "name": "Browse"
          }
        },              {
          "@type": "ListItem",
          "position": "3",
          "item": {
            "@id": "https://f1000research.com/articles/9-1014/v1",
            "name": "Spatial mapping of single cells in the Drosophila embryo from transcriptomic..."
          }
        }          ]
  }
  </script> <div class="breadcrumbs js-breadcrumbs"> <a href="/" class=f1r-standard-link>Home</a> <span class=item_separator></span> <a href="/browse/articles" class=f1r-standard-link>Browse</a> <span class=item_separator></span> Spatial mapping of single cells in the Drosophila embryo from transcriptomic... </div> </div> <div class="article-badges-container u-mb--2"> <div class=crossmark-new> <script src="https://crossmark-cdn.crossref.org/widget/v2.0/widget.js"></script> <a data-target=crossmark><img height=30 width=150 src="https://crossmark-cdn.crossref.org/widget/v2.0/logos/CROSSMARK_Color_horizontal.svg"/></a> </div> <div id=crossmark-dialog style="display: none;" title=""> <iframe id=crossmark-dialog-frame frameborder=0></iframe> </div> <div class=clearfix></div> </div> <div class=article-interaction-container> <div id=main-article-count-box class=article-count-box> <div class="article-metrics-wrapper metrics-icon-wrapper" data-version-id=26653 data-id=24163 data-downloads="" data-views="" data-scholar="10.12688/f1000research.24163.1" data-recommended="" data-doi="10.12688/f1000research.24163.1" data-f1r-ga-helper="Article Page Metrics (Desktop)"> <span class="metrics-on-browse article-metrics-icon f1r-icon icon-89_metrics"></span> <div class="count-title article-metrics-text">ALL Metrics</div> <div class=js-article-metrics-container></div> </div> <div> <div class=count-delimiter></div> <div title="Total views from F1000Research and PubMed Central"> <div class="count-container view-count js-views-count">-</div> <div class=count-title><span class="count-title-icon count-title-views-icon"></span>Views</div> </div> <div class=download-counts hidden> <div class=count-delimiter></div> <div title="Total downloads from F1000Research and PubMed Central"> <div class="count-container js-downloads-count"></div> <div class=count-title><span class="count-title-icon f1r-icon icon-76_download_file"></span>Downloads</div> </div> </div> </div> </div> <div id=main-article-interaction-box class="article-interaction-box has-control-tab"> <div class="article-interaction-info article-page"> <div class=article-interaction-button> <span class="f1r-icon icon-102_download_pdf"></span> <a href="https://f1000research.com/articles/9-1014/v1/pdf?article_uuid=b1043569-6e44-43a5-8d67-9424018193c6" title="Download PDF" class="button-link download pdf-download-helper" target=_blank>Get PDF</a> </div> </div> <div class="article-interaction-info article-page"> <div class=article-interaction-button> <span class="f1r-icon icon-103_download_xml"></span> <a id=download-xml href="#" class="button-link download" title="Download XML">Get XML</a> </div> </div> <div class="article-interaction-info article-page"> <div class="cite-article-popup-wrapper article-page-interaction-box"> <div class="article-interaction-button cite-article-button" title="Cite this article" data-windowref=cite-article-popup-24163-1> <span class="f1r-icon icon-82_quote"></span> <a href="#" class="button-link cite-article-popup-link" title="Cite Article">Cite</a> </div> <div id=cite-article-popup-24163-1 class="popup-window-wrapper is-hidden"> <div class=cite-popup-background></div> <div class="popup-window top-popup cite-this-article-box research-layout"> <div class="popup-window-title small cite-title">How to cite this article</div> <span id=cite-article-text-24163-1 data-test-id=copy-citation_text> <span class="article-title-and-info in-popup">Zand M and Ruan J. Spatial mapping of single cells in the <i>Drosophila</i> embryo from transcriptomic data based on topological consistency [version 1; peer review: awaiting peer review]</span>. <i>F1000Research</i> 2020, <b>9</b>:1014 (<a class=new-orange href="https://doi.org/10.12688/f1000research.24163.1" target=_blank>https://doi.org/10.12688/f1000research.24163.1</a>) </span> <div class="popup-window-title small margin-top-20 margin-bottom-20 note"> <strong>NOTE:</strong> it is important to ensure the information in square brackets after the title is included in all citations of this article. </div> <div class=float-right> <button class="secondary no-fill orange-text-and-border margin-right-20 close-cite-popup uppercase">Close</button> <button id=copy-citation-details class="secondary orange copy-cite-article-version uppercase js-clipboard" title="Copy the current citation details to the clipboard." data-clipboard-target="#cite-article-text-24163-1" data-test-id=copy-citation_button>Copy Citation Details</button> </div> </div> </div> </div> </div> <div class="article-interaction-info article-page"> <div class=article-interaction-button> <span class="f1r-icon icon-76_download_file"></span> <a id=export-citation href="#" class="button-link download" title="Export Citation">Export</a> </div> <div class="modal-window-wrapper is-hidden"> <div id=export-citation-popup class="modal-window padding-20"> <div class=modal-window-close-button></div> <div class=modal-window-title>Export Citation</div> <div class=modal-window-row> <div> <input type=radio name=export-citation-option value=WORKSPACE /> <span class=radio-label>Sciwheel</span> </div> <div> <input type=radio name=export-citation-option value=ENDNOTE /> <span class=radio-label>EndNote</span> </div> <div> <input type=radio name=export-citation-option value=REF_MANAGER /> <span class=radio-label>Ref. Manager</span> </div> <div> <input type=radio name=export-citation-option value=BIBTEX /> <span class=radio-label>Bibtex</span> </div> <div> <input type=radio name=export-citation-option value=PROCITE /> <span class=radio-label>ProCite</span> </div> <div> <input type=radio name=export-citation-option value=SENTE /> <span class=radio-label>Sente</span> </div> </div> <div class=modal-window-footer> <button class=general-white-orange-button id=export-citation-submit>EXPORT</button> </div> <div class=default-error style="display: none;">Select a format first</div> </div> </div> </div> <div class="article-interaction-info article-page"> <div class=article-interaction-button> <span class="f1r-icon icon-90_track"></span> <a class="button-link track-article" data-article-id=24163 id=track-article-signin-24163 title="Receive updates on new activity such as publication of new versions, peer reviews or author responses." href="/login?originalPath=/trackArticle/24163?target=/articles/9-1014/v1">Track</a> </div> </div> <div class="article-interaction-info article-page"> <div class="article-interaction-button email-article"> <span class="f1r-icon icon-6_email"></span> <a href="#" class=button-link title="Email this article">Email</a> </div> <div class="email-article-version-container small-tooltip _chrome-fix"> <div class=close-icon><span class="f1r-icon icon-3_close_big"></span></div> <script src='https://www.recaptcha.net/recaptcha/api.js'></script> <form class="recommend-version-form research-layout"> <p>All fields are required.</p> <input name=versionId type=hidden value=26653 /> <input name=articleId type=hidden value=24163 /> <input name=senderName class="form-input-field reg-form" value="" type=text placeholder="Your name"/> <input name=senderEmail class="form-input-field reg-form margin-top" value="" type=text placeholder="Your email address"/> <textarea name=recipientEmails class="form-textarea-field ninetynine-percent-wide margin-top no-resize" placeholder="Recipient email address(es) (comma delimited)"></textarea> <input class="form-input-field reg-form margin-top" name=subject type=text value="Interesting article on F1000Research" placeholder=Subject /> <textarea name=message class="form-textarea-field reg-form margin-top no-resize">I thought this article from F1000Research (https://f1000research.com) would be of interest to you.</textarea> <div class="g-recaptcha margin-top" data-sitekey=6LcHqxoUAAAAANP3_0TzpGG6qFvl4DhbUcuRzw7W></div> <input value="" name=captcha type=hidden /> <p>A full article citation will be automatically included.</p> <p><img class="ticker-email-article-details hidden" src="/img/ticker.gif" alt=loading /></p> <button class="secondary orange margin-bottom" data-test-id=version_share_email_send>SEND EMAIL</button> <div class="orange-message margin-bottom is-hidden" data-test-id=version_share_email_message></div> </form> </div> </div> <div class="article-interaction-info article-page"> <div class=article-interaction-button> <span class="f1r-icon icon-34_share"></span> <a href="#" class="button-link last addthis_button share-article" title="Share this article">Share</a> </div> </div> </div> <div id=article-interaction-control-tab class=article-interaction-control-tab> <div id=hide-article-interaction class=article-interaction-control title="Hide Toolbox">&#9644;</div> <div id=show-article-interaction class="article-interaction-control open" title="Show Toolbox">&#10010;</div> </div> </div> <div class="article-header-information article-page"> <div class="f1r-article-mobile article-heading-bar"></div> <div class="article-type article-display">Method Article </div> <div class="article-title-and-info article-view highlighted-article" id=anchor-title> <h1>Spatial mapping of single cells in the <i>Drosophila</i> embryo from transcriptomic data based on topological consistency</h1><span class=other-info> [version 1; peer review: awaiting peer review]</span> </div> <div class=article-subtitle></div> <div class=f1r-article-desk> <div class="authors _mdl-layout"><span class="">Maryam Zand<a href="https://orcid.org/0000-0001-6833-1859" target=_blank id=author-orcid-0><span class=orcid-logo-for-author-list></span></a><div class="mdl-tooltip mdl-tooltip--wider" for=author-orcid-0><span class=orcid-logo-for-author-list></span> https://orcid.org/0000-0001-6833-1859</div>,&nbsp;</span><span class=""><a href="mailto:jianhua.ruan@utsa.edu" title="Send email" class="cauthor research-layout"><span class='f1r-icon icon-6_email orange'></span><span>Jianhua Ruan</span></a></span></div> </div> <div class=f1r-article-mobile> <div class="authors _mdl-layout"><span class="">Maryam Zand<a href="http://orcid.org/0000-0001-6833-1859" target=_blank id=mauthor-orcid-0><span class=orcid-logo-for-author-list></span></a><div class="mdl-tooltip mdl-tooltip--wider" for=mauthor-orcid-0><span class=orcid-logo-for-author-list></span> https://orcid.org/0000-0001-6833-1859</div>,&nbsp;</span><span class=""><a href="mailto:jianhua.ruan@utsa.edu" title="Send email" class="cauthor research-layout"><span class='f1r-icon icon-6_email orange'></span><span>Jianhua Ruan</span></a></span></div> </div> <div class=f1r-article-mobile> <div class=article-pubinfo-mobile> PUBLISHED 20 Aug 2020 </div> </div> <span class=Z3988 title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info:ofi/fmt:kev:mtx:journal&amp;rft_id=info:doi/10.12688%2Ff1000research.24163.1"></span> <div class=f1r-article-desk> <div class="contracted-details first"> <a href="#" class="contracted-details-label author-affiliations"><span class=contracted></span>Author details</a> <a href="#" class=section-title>Author details</a> <span class="f1r-icon icon-14_more_small section-control"></span> <span class="f1r-icon icon-10_less_small section-control"></span> <div class="expanded-details affiliations is-hidden"> Computer science, University of Texas at San Antonio, San Antonio, Texas, 78249, USA<br/> <p> <div class=margin-bottom> Maryam Zand <br/> <span>Roles: </span> Conceptualization, Data Curation, Formal Analysis, Investigation, Methodology, Validation, Visualization, Writing  Original Draft Preparation, Writing  Review & Editing </div> <div class=margin-bottom> Jianhua Ruan <br/> <span>Roles: </span> Conceptualization, Formal Analysis, Funding Acquisition, Methodology, Project Administration, Resources, Supervision, Writing  Original Draft Preparation, Writing  Review & Editing </div> </p> </div> </div> </div> <div class=f1r-article-mobile> <div class="article-page-section-box margin-bottom-40 research-layout"> <span class=box-title> <span class="f1r-icon icon-85_peer_review"></span> OPEN PEER REVIEW </span> <div class="status-row referee-reports-container"> REVIEWER STATUS <span class=status-icons> <em>AWAITING PEER REVIEW</em> </span> </div> </div> </div> <div class="f1r-article-desk padding-top"> <div class=article-collection-wrapper> <div class="o-media o-media--sm o-media--center"> <div class=o-media__img> <a href="https://f1000research.com/gateways/dreamchallenges" title="Open Gateway"><img src="https://f1000researchdata.s3.amazonaws.com/thumbnails/0b514d2b-546b-4b32-9b01-43c630a9aaa9_collection.thumbnail"></a> </div> <div class=o-media__body> <p class="u-mt--0 u-mb--0">This article is included in the <a href="https://f1000research.com/gateways/dreamchallenges">DREAM Challenges</a> gateway.</p> </div> </div> </div> </div> </div> <h2 class="article-headings article-page-abstract" id=anchor-abstract> <span class="f1r-article-mobile-inline abstract-heading-border"></span> Abstract </h2> <div class="article-abstract article-page-general-text-mobile research-layout"> <div class="abstract-text is-expanded"> The advancement in single-cell RNA sequencing technologies allow us to obtain transcriptome at single cell resolution. However, the original spatial context of cells, a crucial knowledge for understanding cellular and tissue-level functions, is often lost during sequencing. To address this issue, the DREAM Single Cell Transcriptomics Challenge launched a community-wide effort to seek computational solutions for spatial mapping of single cells in tissues using single-cell RNAseq (scRNA-seq) data and a reference atlas obtained from in situ hybridization data. As a top-performing team in this competition, we approach this problem in three steps. The first step involves identifying a set of most informative genes based on the consistency between gene expression similarity and cell proximity. For this step, we propose two different approaches, i.e., an unsupervised approach that does not utilize the gold standard location of the cells provided by the challenge organizers, and a supervised approach that relies on the gold standard locations. In the second step, a Particle Swarm Optimization algorithm is used to optimize the weights of different genes in order to maximize matches between the predicted locations and the gold standard locations. Finally, the information embedded in the cell topology is used to improve the predicted cell-location scores by weighted averaging of scores from neighboring locations. Evaluation results based on DREAM scores show that our method accurately predicts the location of single cells, and the predictions lead to successful recovery of the spatial expression patterns for most of landmark genes. In addition, investigating the selected genes demonstrates that most predictive genes are cluster specific, and stable across our supervised and unsupervised gene selection frameworks. Overall, the promising results obtained by our methods in DREAM challenge demonstrated that topological consistency is a useful concept in identifying marker genes and constructing predictive models for spatial mapping of single cells. </div> <div class=abstract-for-mobile> <div class="margin-top-30 padding-bottom-30 research-layout is-centered"> <button class="primary orange-text white-bg bigger-text abstract-expand-button-mobile with-border show" style="display: none;"> READ ALL <span class="f1r-icon icon-14_more_small orange vmiddle big"></span> </button> <button class="primary orange-text white-bg bigger-text abstract-expand-button-mobile with-border hide"> READ LESS <span class="f1r-icon icon-10_less_small orange vmiddle big"></span> </button> </div> </div> </div> <div class=clearfix></div> <div class="article-context no-divider"> <div class="article-abstract article-page-general-text-mobile research-layout generated-article-body"> <h2 class=main-title>Keywords</h2> <p class="u-mb--0 u-pb--2"> Single cell RNA-seq, spatial mapping, feature selection, particle swarm intelligence, nearest neighbor </p> </div> </div> <div class=article-information> <span class="info-separation padding-bottom"> <div id=corresponding-author-icon class="email-icon float-left"> <span class="f1r-icon icon-6_email orange"></span> <div id=corresponding-author-window class="margin-top-20 popup-window-wrapper is-hidden"> <div class="popup-window corresponding-authors-popup"> <div class=corresponding-author-container> <div class="popup-window-title small">Corresponding Author(s)</div> <div class=authors> Jianhua Ruan (<a href="mailto:jianhua.ruan@utsa.edu">jianhua.ruan@utsa.edu</a>) </div> </div> <div class="margin-top margin-bottom float-left"> <button id=close-popup-window class=general-white-orange-button>Close</button> </div> </div> </div> </div> <span class="icon-text float-left" data-test-id=box-corresponding-author> <b>Corresponding author:</b> Jianhua Ruan </span> <div class=clearfix></div> </span> <span class="info-separation padding-bottom competing-interests-display"> <span class=competing-interests-title>Competing interests:</span> No competing interests were disclosed. </span> <div class="info-separation padding-bottom grant-information-display"> <span class=grant-information-title>Grant information:</span> This research was funded by National Science Foundation [1565076] and National Institutes of Health [U54CA217297]. <br/> <i>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</i> </div> <span class="f1r-article-desk info-separation padding-bottom"> <span class="copywrite-icon float-left"> <span class="f1r-icon icon-100_open_access"></span> </span> <span class="icon-text float-left" data-test-id=box-copyright-text> <b>Copyright:</b>&nbsp;  2020 Zand M and Ruan J. This is an open access article distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/" target=_blank data-test-id=box-licence-link>Creative Commons Attribution License</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. </span> <div class=clearfix></div> </span> <span class="info-separation padding-bottom" data-test-id=box-how-to-cite> <b>How to cite:</b> <span class="article-title-and-info in-article-box"> Zand M and Ruan J. Spatial mapping of single cells in the <i>Drosophila</i> embryo from transcriptomic data based on topological consistency [version 1; peer review: awaiting peer review]</span>. <i>F1000Research</i> 2020, <b>9</b>:1014 (<a href="https://doi.org/10.12688/f1000research.24163.1" target=_blank>https://doi.org/10.12688/f1000research.24163.1</a>) </span> <span class=info-separation data-test-id=box-first-published><b>First published:</b> 20 Aug 2020, <b>9</b>:1014 (<a href="https://doi.org/10.12688/f1000research.24163.1" target=_blank>https://doi.org/10.12688/f1000research.24163.1</a>)</span> <span class=info-separation data-test-id=box-latest-published><b>Latest published:</b> 20 Aug 2020, <b>9</b>:1014 (<a href="https://doi.org/10.12688/f1000research.24163.1" target=_blank>https://doi.org/10.12688/f1000research.24163.1</a>)</span> </div> <div class=clearfix></div> <div id=article-context class=article-context> <div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e154>Introduction</h2><p class="" id=d32386e157>Single cell RNA sequencing (scRNA-seq) is a cost-efficient, high throughput technology that has dramatically enhanced our understanding of developmental biology such as cell type identification, regulatory network inference, and cell trajectories<sup><a href="#ref-1">1</a><a href="#ref-7">7</a></sup>. Despite many breakthroughs in biological sciences made possible by this technology, it yet suffers from the drawback that native cell location in e.g. embryo or complex tissue is often lost, except for in a few experimental methodologies which are either expensive, require highly specialized tools, or are not as widely applicable as standard scRNA-seq protocols<sup><a href="#ref-8">8</a><a href="#ref-11">11</a></sup>. Given the substantial benefit offered through cell location recovery, such as obtaining a basic understanding of tissue function and disease pathology<sup><a href="#ref-12">12</a>,<a href="#ref-13">13</a></sup>, the cell spatial reconstruction was specifically addressed in recent Single Cell Transcriptome DREAM challenge as a community-wide effort.</p><p class="" id=d32386e181>Many promising computational approaches dealing with the spatial reconstitution problem are centered around the main idea that an <i>in situ</i> atlas of a set of landmark genes expressions is used as a guideline to be combined with scRNA-seq profiles of individually measured cell<sup><a href="#ref-14">14</a>,<a href="#ref-15">15</a></sup>. For instance, Seurat<sup><a href="#ref-14">14</a></sup> first imputes the noisy scRNAseq data then predicts the cell locations by comparing the scRNAseq gene expression pattern to its binary expression level measured by <i>in situ</i> data. This step is done through a mixture model. Finally, original cell location is retrieved by evaluating a posterior probability function constructed for cell-bin pairs. DistMap<sup><a href="#ref-15">15</a></sup> was a successful method for spatial reconstruction (of <i>Drosophila</i> embryo) with near single cell resolution, much higher compared to that of Seurat (3039 bins versus 128 bins). It predicts top candidate positions for a given cell by calculating the Mathews Correlation Coefficients (MCC) of binarized landmark gene expressions for every cell-bin combination. While DistMap was to some extent successful in dealing with the cell spatial mapping problem, it was limited to binarized data rather than continuous, utilized simplistic MCC analysis, and more importantly it treats each single cell independently whereas it might be more beneficial to account for collective interrelationships between cells. To more extensively explore the space of better predictive strategies, DREAM challenge aimed to exploit the atlas provided by DistMap with the hope of resolving spatial reconstruction by using incrementally fewer landmark genes (i.e. 60,40,20). Achieving this goal will help with eliminating the need for <i>a priori</i> reference atlas, which is expensive and time-consuming to obtain, in the future transcriptomic studies.</p><p class="" id=d32386e212>In this work, we proposed a top-performing method (evaluated based on three distinct scoring criteria defined by DREAM challenge) which allows us to predict the cell location consistently as accurate as DistMap while requiring fewer number of landmark genes. The details of our method and evaluation metrics are provided later in the text.</p></div><div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e218>Methods</h2><div class=section><a name=d32386e221 class=n-a></a><h3 class=section-title>Overview of the proposed method</h3><p class="" id=d32386e226>The general overview of our method is such that in the first step we investigate both supervised and unsupervised feature selection methods by defining two biologically rational metrics optimizing the consistency between gene expression similarity and cell proximity. In the unsupervised version we do not use the predicted cell locations given in <a href="#ref-15">15</a> to obtain the set of most informative genes (e.g. 60,40,20), thus avoiding overfitting. On the other hand, the supervised version uses the cell locations given by DistMap as a reference. In the next, to predict the final cell locations, we use a PSO algorithm to assign proper weights to genes based on fitness functions defined by gene expression patterns. This reflects the intuition that different landmark genes are expected to demonstrate different potential in guiding us toward the proper embryo reconstruction. Finally, we use the information embedded in the cell topology to adjust the associated cell-location score with the hope to improve the predictions.</p></div><div class=section><a name=d32386e233 class=n-a></a><h3 class=section-title>Datasets and pre-processing steps</h3><p class="" id=d32386e238>To reconstruct <i>Drosophila</i> embryo from single cells, we need reference dataset (<i>in situ</i>), spatial coordinates, and scRNA-seq data, the details of which along with the preprosseing steps are given in the following.</p><p class="" id=d32386e247><b>Reference database</b> The reference database (denoted as <i>W</i>) provides the <i>in situ</i> expression values as a <i>W</i><sub>303984</sub> matrix where rows and columns correspond to bin locations and marker genes, respectively. The original data comes from Berkeley <a target=xrefwindow href="http://bdtnp.lbl.gov:8080/Fly-Net/" id=d32386e262>Drosophila Transcription Network Project (BDTNP)</a> and in here we used the binarized format as explained in <a href="#ref-15">15</a>.</p><p class="" id=d32386e270><b>Spatial coordinates</b> The spatial coordinate information from one half of <i>Drosophila</i> embryo (denoted as <i>L</i>) is an <i>L</i><sub>30393</sub> matrix where the columns are <i>x</i>, <i>y</i>, and <i>z</i> coordinates of 3039 rows of bins.</p><p class="" id=d32386e296><b>Single cell RNA sequencing</b> The scRNA-seq data (denoted as <i>Y</i>) gives the gene expression values as a <i>Y</i><sub>12978924</sub> matrix where rows and columns are single cells and genes, respectively. In here we followed the normalization process as implemented by <a href="#ref-15">15</a>. Briefly, the raw data was first normalized with respect to the total number of unique molecular identifiers (UMI) for each cell, followed by a pseudo count addition and a log transformation. The binarization process was implemented such that the quantile was varied in order to obtain the minimum mean squared root error between the gene correlation matrix of binarized atlas and binarized scRNA-seq.</p></div><div class=section><a name=d32386e313 class=n-a></a><h3 class=section-title>Finding most informative genes</h3><p class="" id=d32386e318>In this study, our first goal is to identify a subset of genes whose expression patterns are predictive of cell locations. We have proposed two different feature selection methods (supervised and unsupervised) to select informative genes. In the supervised method, our metric was defined based on true cell locations (gold standard). To prevent overfitting we applied a 10 fold cross validation. On the other hand, we designed an unsupervised method based on the intuition that the current locations obtained by matching the normalized and binarized scRNA-seq expression patterns with the <i>in situ</i> expression patterns are not necessarily the true locations of these cells. These two methods are discussed in detail in the following sections.</p></div><div class=section><a name=d32386e325 class=n-a></a><h3 class=section-title>Unsupervised gene selection</h3><p class="" id=d32386e330>As we believe the current locations obtained by matching the normalized and binarized scRNA-seq expression patterns with the <i>in situ</i> expression patterns are not necessarily the true locations of these cells, we decided to take an unsupervised feature selection approach, which does not depend on the current locations of the cells to be predicted, and therefore avoid overfitting.</p><p class="" id=d32386e336>The key rationale in our unsupervised feature selection method is that if a set of genes can be used as predictors of cell locations, then the cells showing similar expression patterns of these genes must be geometrically close to each other. Therefore, we defined two complementary metrics to quantitatively measure the proximity of cells with similar expression patterns for different gene subsets, and developed a greedy algorithm to search for a gene subset with the optimal (minimal) score combining the two metrics.</p><p class="" id=d32386e339><b><i>Metrics to measure the power of gene signatures as location predictors</i></b>. The first metric relies solely on the <i>in situ</i> gene expression patterns in the 3039 location bins, and is calculated as follows: given a set of genes <i>G</i> as features, the pairwise Pearson Correlation Coefficient (PCC) is computed between the <i>in situ</i> expression data for every pair of the 3039 location bins; the top-10 locations with the highest PCC is then identified for each location bin; the metric <span class=inline-formula><math display=inline id=M1 overflow=scroll><mrow><msubsup><mi>M</mi><mn>1</mn><mi>G</mi></msubsup></mrow></math></span> is defined as the average Euclidean distance between each location bin and its top-10 most similar location bins: <a name=d32386e364 class=n-a></a><div class="disp-formula panel"><math display=block id=math1 overflow=scroll><mrow><msubsup><mi>M</mi><mn>1</mn><mi>G</mi></msubsup><mo>=</mo><mfrac><mrow><mstyle displaystyle=true><msubsup><mo></mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mstyle displaystyle=true><msub><mo></mo><mrow><mi>j</mi><mo></mo><msubsup><mi>L</mi><mrow><mi>k</mi><mi>i</mi></mrow><mi>G</mi></msubsup></mrow></msub><mrow><msub><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle></mrow></mstyle></mrow><mrow><mi>k</mi><mo></mo><mi>n</mi></mrow></mfrac><mo>,</mo><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></math></div> where <span class=inline-formula><math display=inline id=M2 overflow=scroll><mrow><msubsup><mi>L</mi><mtext mathvariant=italic>ki</mtext><mi>G</mi></msubsup></mrow></math></span> is the set of <i>k</i> most similar bins for location <i>i</i> based on the <i>in situ</i> expression pattern of a gene signature <i>G</i>, <i>k</i> is fixed at 10 in this work, and <i>n</i> =3039 is the total number of location bins. <i>D<sub>ij</sub></i> is the Euclidean distance between the geometric coordinates of location <i>i</i> and location <i>j</i>.</p><p class="" id=d32386e480>The second metric uses information from both the <i>in situ</i> expression data and the scRNA-seq expression data, and is calculated as follows. Given a set of genes <i>G</i> as features, the pairwise PCC is computed between the scRNA-seq expression pattern of each of the 1297 cells and the <i>in situ</i> expression pattern of each of the 3039 location bins; then for each of the 1297 cells, the top-10 location bins with the highest PCC is identified; the metric <span class=inline-formula><math display=inline id=M3 overflow=scroll><mrow><msubsup><mi>M</mi><mn>2</mn><mi>G</mi></msubsup></mrow></math></span> is defined as the average Euclidean distance between the geometric coordinates of the location bin most similar to cell <i>c</i> and the geometric coordinates of the top-10 most similar location bins (including the most similar location): <a name=d32386e506 class=n-a></a><div class="disp-formula panel"><math display=block id=math2 overflow=scroll><mrow><msubsup><mi>M</mi><mn>2</mn><mi>G</mi></msubsup><mo>=</mo><mfrac><mrow><mstyle displaystyle=true><msubsup><mo></mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mrow><mstyle displaystyle=true><msub><mo></mo><mrow><mi>j</mi><mo></mo><msubsup><mi>S</mi><mrow><mi>k</mi><mi>c</mi></mrow><mi>G</mi></msubsup></mrow></msub><mrow><msub><mi>D</mi><mrow><msubsup><mi>l</mi><mi>c</mi><mi>G</mi></msubsup><mi>j</mi></mrow></msub></mrow></mstyle></mrow></mstyle></mrow><mrow><mi>k</mi><mo></mo><mi>m</mi></mrow></mfrac><mo>,</mo><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>2</mn><mo stretchy=false>)</mo></mrow></math></div> where <span class=inline-formula><math display=inline id=M4 overflow=scroll><mrow><msubsup><mi>S</mi><mtext mathvariant=italic>kc</mtext><mi>G</mi></msubsup></mrow></math></span> is the set of top-<i>k</i> locations whose <i>in situ</i> expression patterns are most similar to the scRNA-seq expression pattern of cell <i>c</i> based on gene signature <i>G</i>, <i>k</i> is fixed at 10 in this work, and <i>m</i> =1297 is the total number of cells whose locations are to be predicted. <span class=inline-formula><math display=inline id=M5 overflow=scroll><mrow><msubsup><mi>l</mi><mi>c</mi><mi>G</mi></msubsup></mrow></math></span> is the location bin where the expression pattern of gene signature <i>G</i> is most similar to cell <i>c</i>.</p><p class="" id=d32386e633>Note that the currently known most possible location of each cell <i>c</i>, <span class=inline-formula><math display=inline id=M6 overflow=scroll><mrow><msubsup><mi>l</mi><mi>c</mi><mi>*</mi></msubsup></mrow></math></span> which is predicted using all 84 genes with uniform weights, are not used in either <i>M</i><sub>1</sub> and <i>M</i><sub>2</sub>; therefore, the gene selection process is not biased towards identifying genes to match the original locations predicted by the 84 genes. Rather, the metric provides an intrinsic measurement of the power of any subset of genes as location predictors, independent of the locations predicted with the 84 genes. In fact, the quality of the 84 genes as predictors can also be measured using these two metrics, and compared to any other gene sets; it is possible that a subset of the 84 genes can receive higher scores in these two metrics than the original 84 genes. In contrast, using a supervised feature selection method, where the true location is defined using all 84 genes, any subset of genes will be necessarily inferior to the complete set of 84 genes.</p><p class="" id=d32386e660><b><i>Step-wise backward elimination feature selection algorithm</i></b>. We used a standard backward elimination algorithm to identify a subset of genes <i>G</i> with the minimal sum of <span class=inline-formula><math display=inline id=M7 overflow=scroll><mrow><msubsup><mi>M</mi><mn>1</mn><mi>G</mi></msubsup><mspace width="0.2em"></mspace><mtext>and</mtext><mspace width="0.2em"></mspace><msubsup><mi>M</mi><mn>2</mn><mi>G</mi></msubsup></mrow></math></span>. Briefly, starting with a set of <i>q</i> genes, we computed <span class=inline-formula><math display=inline id=M8 overflow=scroll><mrow><msubsup><mi>M</mi><mn>1</mn><mi>G</mi></msubsup><mspace width="0.2em"></mspace><mtext>and</mtext><mspace width="0.2em"></mspace><msubsup><mi>M</mi><mn>2</mn><mi>G</mi></msubsup></mrow></math></span> for all possible subsets of <i>q</i>  1 genes by removing one gene at a time from the set. The subset with the minimal <span class=inline-formula><math display=inline id=M9 overflow=scroll><mrow><msubsup><mi>M</mi><mn>1</mn><mi>G</mi></msubsup><mo>+</mo><msubsup><mi>M</mi><mn>2</mn><mi>G</mi></msubsup></mrow></math></span> is then recorded as the best subset of size <i>q</i>  1. This procedure is then repeated until a desired number of genes is reached. As this algorithm is a greedy approach, it does not guarantee to find the optimal solution. We have also attempted to combine backward elimination with forward selection, which only improved the solution slightly. Due to the excessive running time required, we opted to use the simple algorithm described above while leaving additional improvement as future work.</p></div><div class=section><a name=d32386e745 class=n-a></a><h3 class=section-title>Supervised gene selection</h3><p class="" id=d32386e750>While in the unsupervised approach metrics <i>M</i>1 and <i>M</i>2 were optimized, in the supervised version a single metric <i>N</i> was defined as explained below. This metric, which relies on both the scRNA-seq gene expression patterns in the 1297 cells and the gold standard location of each cell, is calculated as follows: given a set of genes <i>G</i> as features, the pairwise PCC is computed between the scRNA-seq expression data for every pair of the 1297 cells; the top-10 cells with the highest PCC is then identified for each cell; the metric <i>N<sup>G</sup></i> is defined as the average Euclidean distance between the gold standard geometric coordinates of each cell and its top-10 most similar cells: <a name=d32386e770 class=n-a></a><div class="disp-formula panel"><math display=block id=math3 overflow=scroll><mrow><msup><mi>N</mi><mi>G</mi></msup><mo>=</mo><mfrac><mrow><mstyle displaystyle=true><msubsup><mo></mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mrow><mstyle displaystyle=true><msub><mo></mo><mrow><mi>j</mi><mo></mo><msubsup><mi>T</mi><mrow><mi>k</mi><mi>c</mi></mrow><mi>G</mi></msubsup></mrow></msub><mrow><msub><mi>D</mi><mrow><msubsup><mi>l</mi><mi>c</mi><mo>*</mo></msubsup><msubsup><mi>l</mi><mi>j</mi><mo>*</mo></msubsup></mrow></msub></mrow></mstyle></mrow></mstyle></mrow><mrow><mi>k</mi><mo></mo><mi>m</mi></mrow></mfrac><mo>,</mo><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>3</mn><mo stretchy=false>)</mo></mrow></math></div> where <span class=inline-formula><math display=inline id=M10 overflow=scroll><mrow><msubsup><mi>T</mi><mtext mathvariant=italic>kc</mtext><mi>G</mi></msubsup></mrow></math></span> is the set of top-<i>k</i> cells whose scRNA-seq expression patterns are most similar to the scRNA-seq expression pattern of cell <i>c</i> based on gene signature <i>G</i>, <i>k</i> is fixed at 10 in this work, and <i>m</i> =1297 is the total number of cells whose locations are to be predicted. <span class=inline-formula><math display=inline id=M11 overflow=scroll><mrow><msubsup><mi>l</mi><mi>c</mi><mo>*</mo></msubsup></mrow></math></span> is the gold standard cell location for cell <i>c</i>, which is predicted using all 84 genes.</p></div><div class=section><a name=d32386e894 class=n-a></a><h3 class=section-title>Supervised learning to find optimal gene weights</h3><p class="" id=d32386e899>It is intuitive to assume that the contribution of genes in determining cell locations are not equal. Therefore, we look for a way to learn how to assign proper weight to each selected gene for more accurate prediction of cell locations. To this end, we chose a supervised learning approach, using the cell locations predicted by the highest MCCs with the 84 signature genes as gold standard locations. To avoid overfitting, we performed 10-fold cross-validation: gene weights were determined using the scRNA-seq data of 90% of cells; these weights are then used to predict the locations of the remaining 10% of the cells not used in training. The splitting of the data is saved, for reproducibility of the results.</p><p class="" id=d32386e902>The basic idea of the PSO algorithm is as follows. We created a set of agents, each of which is initiated with a gene weight vector <i>w<sub>i</sub></i> of size |<i>G</i>| 1. Each weight vector is evaluated by how closely the weighted gene expression pattern can be used to predict the cell locations when compared to the gold standard locations obtained with the 84 genes: <a name=d32386e912 class=n-a></a><div class="disp-formula panel"><math display=block id=math4 overflow=scroll><mrow><msubsup><mi>M</mi><mn>3</mn><mrow><mi>w</mi><mo>,</mo><mi>G</mi></mrow></msubsup><mo>=</mo><mfrac><mrow><msubsup><mo></mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mo></mo><mrow><mi>j</mi><mo></mo><msubsup><mi>S</mi><mrow><mi>k</mi><mi>c</mi></mrow><mrow><mi>w</mi><mo>,</mo><mi>G</mi></mrow></msubsup></mrow></msub><msub><mi>D</mi><mrow><msubsup><mi>l</mi><mi>c</mi><mo>*</mo></msubsup><mi>j</mi></mrow></msub></mrow><mrow><mi>k</mi><mo></mo><mi>m</mi></mrow></mfrac><mo>,</mo><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>4</mn><mo stretchy=false>)</mo></mrow></math></div> where <span class=inline-formula><math display=inline id=M12 overflow=scroll><mrow><msubsup><mi>S</mi><mrow><mi>k</mi><mi>c</mi></mrow><mrow><mi>w</mi><mo>,</mo><mi>G</mi></mrow></msubsup></mrow></math></span> is the set of top-<i>k</i> location bins whose <i>in situ</i> expression patterns are most similar to the weighted expression pattern of cell <i>c</i> based on a given gene signature set <i>G</i>. The similarity is measured by PCC here. <i>k</i> is fixed at 10, and <i>m</i> is the total number of cells in the training set. <span class=inline-formula><math display=inline id=M13 overflow=scroll><mrow><msubsup><mi>l</mi><mi>c</mi><mo>*</mo></msubsup></mrow></math></span> is the gold standard cell location for cell <i>c</i>, which is predicted using all 84 genes with uniform weights.</p><p class="" id=d32386e1050>During the search, each agent keeps track of a personal best weight vector <i>P best<sub>i</sub></i>, and the global best solution from all agents is denoted <i>Gbest</i>. At each iteration, the weight vector of each agent is updated by the differences between the current weight and the personal best and global best weight vectors: <a name=d32386e1060 class=n-a></a><div class="disp-formula panel"><math display=block id=math5 overflow=scroll><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mi></mi><mo></mo><msub><mi>r</mi><mn>1</mn></msub><mo></mo><mrow><mo>(</mo><mrow><mi>P</mi><mi>b</mi><mi>e</mi><mi>s</mi><msub><mi>t</mi><mi>i</mi></msub><mo></mo><msub><mi>w</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mi></mi><mo></mo><msub><mi>r</mi><mn>2</mn></msub><mo></mo><mrow><mo>(</mo><mrow><mi>G</mi><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo></mo><msub><mi>w</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>,</mo></mrow></math></div> where <i></i> and <i></i> are constants to control the granularity of the search and speed of convergence. We choose <i></i> = <i></i> = 0.2 with 200 agents and the maximum number of iterations is 40. The operator  denotes entry-wise vector multiplication. <i>r</i><sub>1</sub> and <i>r</i><sub>2</sub> are vectors of random numbers uniformly distributed between 0 and 1, generated independently for each agent at each iteration.</p></div><div class=section><a name=d32386e1177 class=n-a></a><h3 class=section-title>Neighbor-weighted cell location prediction</h3><p class="" id=d32386e1182>The location prediction for each single cell relies on the (weighted) similarity between the expression pattern of selected signature genes in the cell and every location bin. It is important to note that the expression patterns in neighboring cells should be similar in general, and therefore the overall prediction should take the expression of nearby location bins into consideration. Intuitively, if the globally highest scoring location is far away from locations with slightly lower but comparable scores, the confidence score for the highest-scoring location should be reduced; on the other hand, a locally highest-scoring location close to other high-scoring locations should be upweighted. Therefore, to make the final prediction for a given cell, we adjusted the prediction score based on the prediction scores from neighbor locations.</p><p class="" id=d32386e1185>Formally, let <i>C</i> = (<i>c<sub>ij</sub></i>)<sub><i>n</i><i>m</i></sub> be the bin-cell association matrix, where <i>c<sub>ij</sub></i> is the PCC between the (weighted) scRNA-seq data and the <i>in situ</i> hybridization data for every pair of cells and locations. <i>n</i> = 3039 is the number of candidate location bins, and <i>m</i> is the number of cells in the test set, Let <i>D</i> = (<i>d<sub>ij</sub></i>)<sub><i>nn</i></sub> be the Euclidean distance matrix between the geometric coordinates of every pair of location bins. We define an affinity matrix <i>A</i> = (<i>a<sub>ij</sub></i>)<sub><i>nn</i></sub> such that <span class=inline-formula><math display=inline id=M14 overflow=scroll><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msup><mi>e</mi><mrow><mo></mo><mfrac><mrow><msub><mi>d</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi>d</mi><mo>*</mo><mo>,</mo></mrow></mfrac></mrow></msup></mrow></math></span> where <i>d*</i> is a parameter to control how many neighbor locations can impact the final prediction score. A smaller <i>d*</i> value means fewer neighbor locations to be considered. To have a robust measure of how geometrically close two location bins can be, we first measure the distance between each location and its nearest location, and then computed the median of these shortest distances as <i>d*</i>. As a result, most <i>a<sub>ij</sub></i>s are much smaller than <i>e</i><sup>1</sup>, and only a limited number of neighbor locations with very high scores can impact the final prediction score for each cell.</p><p class="" id=d32386e1300>The final prediction score matrix <i>P</i> = (<i>p<sub>ij</sub></i>)<sub><i>n</i><i>m</i></sub> is calculated by <i>P</i> = <i>A  C</i>. Since <i>a<sub>ii</sub></i> = 1 and <i>a<sub>ij</sub></i>  1 for all <i>j</i>  <i>i</i>, it is easy to see that <a name=d32386e1340 class=n-a></a><div class="disp-formula panel"><math display=block id=math6 overflow=scroll><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mstyle displaystyle=true><munderover><mo></mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>c</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mstyle><mo>+</mo><mstyle displaystyle=true><munder><mo></mo><mrow><mi>k</mi><mo></mo><mi>j</mi></mrow></munder><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>c</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo></mo></mrow></mstyle></mrow></math></div> Therefore, the final prediction score for a cell <i>i</i> to be at a particular location <i>j</i> is the weighted sum of the similarity scores between the expression pattern of cell <i>i</i> and all locations, where the weight is an exponentially decreasing function of the geometric distance from location <i>j</i>.</p><p class="" id=d32386e1440>From the final predicted bin-cell association matrix, we reported the 10 locations with the highest scores for each cell as the most likely positions in embryo.</p></div><div class=section><a name=d32386e1444 class=n-a></a><h3 class=section-title>How proposed method applied to different subchallenges</h3><p class="" id=d32386e1449>In subchallenge 1 we performed both PSO and neighbor weighting. In subchallenge 2, we did not perform PSO; therefore, the 40 genes obtained from gene selection are utilized with uniform weights. In subchallenge 3, genes were weighted with the PSO procedure, but we chose not to perform neighbor weighting.</p></div><div class=section><a name=d32386e1453 class=n-a></a><h3 class=section-title>Post-challenge phase</h3><p class="" id=d32386e1458>In this phase to evaluate the robustness and soundness of the method, a 10 fold CV scenario was performed to obtain 10 different sets of informative genes using a subset of cells. To compare the similarity of the selected genes, Jaccard similarity was defined as follows: <a name=d32386e1460 class=n-a></a><div class="disp-formula panel"><math display=block id=math7 overflow=scroll><mrow><mi>J</mi><mrow><mo>(</mo><mrow><mi>A</mi><mo>,</mo><mi>B</mi></mrow><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mrow><mo>|</mo><mrow><mi>A</mi><mo></mo><mi>B</mi></mrow><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo><mrow><mi>A</mi><mo></mo><mi>B</mi></mrow><mo>|</mo></mrow></mrow></mfrac><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>5</mn><mo stretchy=false>)</mo></mrow></math></div> where <i>A</i> and <i>B</i> are two sets of informative genes and <i>J</i>(<i>A</i>, <i>B</i>) measures the ratio of the number of common genes and the total number of genes presented in two sets. In addition, the expected Jaccard similarity was computed as follows: <a name=d32386e1530 class=n-a></a><div class="disp-formula panel"><math display=block id=math8 overflow=scroll><mrow><mi mathvariant=double-struck>E</mi><mrow><mo>(</mo><mi>J</mi><mo>)</mo></mrow><mo>=</mo><mstyle displaystyle=true><munderover><mo></mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><mrow><mstyle scriptlevel="+1"><mfrac><mi>k</mi><mrow><mn>2</mn><mi>m</mi><mo></mo><mi>k</mi></mrow></mfrac></mstyle><mfrac><mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mi>m</mi></mtd></mtr><mtr><mtd><mi>k</mi></mtd></mtr></mtable></mrow><mo>)</mo></mrow><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mrow><mi>n</mi><mo></mo><mi>m</mi></mrow></mtd></mtr><mtr><mtd><mrow><mi>m</mi><mo></mo><mi>k</mi></mrow></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mrow><mrow><mtable><mtr><mtd><mi>n</mi></mtd></mtr><mtr><mtd><mi>m</mi></mtd></mtr></mtable></mrow></mfrac></mrow></mstyle><mspace width="1.5em"></mspace><mo stretchy=false>(</mo><mn>6</mn><mo stretchy=false>)</mo></mrow></math></div> where, <i>n</i> is the total number of genes, here 84, and <i>m</i> is the number of genes in our selected gene set, 60,40, and 20 for subchallenge 1,2, and 3, respectively.</p></div><div class=section><a name=d32386e1639 class=n-a></a><h3 class=section-title>Validation of model by DREAM consortium</h3><p class="" id=d32386e1644>Our method was designated as a top-performing method among 34 participating teams. To evaluate and rank the teams, the challenge organizers had defined three scoring metrics s1,s2, and s3, which were not disclosed to participants at the time of submission. The details of each metric are available at <a target=xrefwindow href="https://github.com/dream-sctc/Scoring" id=d32386e1646>https://github.com/dream-sctc/Scoring</a>. Here, we briefly explain the general intuition and purpose behind each scoring metric. Roughly speaking, s1 stands for how the gene expression of the 10 most probable predicted position for all cells closely approximates that of the <i>in situ</i> expression pattern of the gold standard locations (as predicted by DistMap). On the other hand, s2 only considers how the averaged location prediction of the 10 most probable predictions using 60, 40, and 20 genes is compared to that of the one predicted by using all the 84 genes. As is evident, this metric does not include either of the accuracy of the <i>in situ</i> expression profile prediction and the closeness of <i>in situ</i> and scRNA-seq data. Meanwhile, s3 accounts for how the scRNA-seq expression of 60,40, and 20 genes of the best predicated locations is closely approximating that of the <i>in situ</i> expression patterns.</p></div><div class=section><a name=d32386e1664 class=n-a></a><h3 class=section-title>Software</h3><p class="" id=d32386e1669>The method proposed here is written in Matlab 2018b and the source code is available from <a target=xrefwindow href="https://github.com/mary77/scSpatialMapping" id=d32386e1671>GitHub</a><sup><a href="#ref-16">16</a></sup></p><p class="" id=d32386e1677>It does not utilize or rely on any specific Matlab toolbox. Therefore by following the clear detailed formulation provided in manuscript this method can readily be implemented in any open-access software.</p></div></div><div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e1684>Results and Discussion</h2><div class=section><a name=d32386e1687 class=n-a></a><h3 class=section-title>Performance evaluation</h3><p class="" id=d32386e1692>In the two supervised and unsupervised methods discussed so far there exist two important components implemented with the intention to both select a set of most informative genes and locate cells based on the information buried in cell neighborhood network topology. To elucidate the effectiveness of these two components, we designed a set of four experiments in which the first component was replaced either by random gene selection or a simple strategy of high degree gene selection and the second component was inactivated. The subchallenge scores for these total of six methods are given in <a href="#T1">Table 1</a>. To quantify the effectiveness of the two mentioned components we calculated the average score of the group A, containing supervised and unsupervised, and group B, containing the remaining four methods. Our analysis showed that on average the score of group A were higher by 14%, 20%, 30% in the subchallenges 1, 2, and 3 respectively. The reason for the greater performance in subchallenge 3 was expected given that fewer number of genes were used compare to the other two subchallenges.</p><a name=T1 class=n-a></a><div class="table-wrap panel clearfix"><div class=caption><h3>Table 1. Numerical values of subchallenges scores are given for the ease of comparison with some designed baseline methods.</h3></div><table xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" class=article-table frame=below><a name=d32386e1709 class=n-a></a><thead><a name=d32386e1711 class=n-a></a><tr><a name=d32386e1713 class=n-a></a><th align=center colspan=1 rowspan=1><a name=d32386e1715 class=n-a></a></th><th align=center colspan=3 rowspan=1><a name=d32386e1717 class=n-a></a>SubCh1</th><th align=center colspan=3 rowspan=1><a name=d32386e1720 class=n-a></a>SubCh2</th><th align=center colspan=3 rowspan=1><a name=d32386e1723 class=n-a></a>SubCh3</th></tr><tr><a name=d32386e1727 class=n-a></a><th align=left colspan=1 rowspan=1><a name=d32386e1729 class=n-a></a>gene selection method</th><th align=center colspan=1 rowspan=1><a name=d32386e1732 class=n-a></a>s1</th><th align=center colspan=1 rowspan=1><a name=d32386e1735 class=n-a></a>s2</th><th align=center colspan=1 rowspan=1><a name=d32386e1738 class=n-a></a>s3</th><th align=center colspan=1 rowspan=1><a name=d32386e1741 class=n-a></a>s1</th><th align=center colspan=1 rowspan=1><a name=d32386e1745 class=n-a></a>s2</th><th align=center colspan=1 rowspan=1><a name=d32386e1748 class=n-a></a>s3</th><th align=center colspan=1 rowspan=1><a name=d32386e1751 class=n-a></a>s1</th><th align=center colspan=1 rowspan=1><a name=d32386e1754 class=n-a></a>s2</th><th align=center colspan=1 rowspan=1><a name=d32386e1757 class=n-a></a>s3</th></tr></thead><tbody><a name=d32386e1762 class=n-a></a><tr><a name=d32386e1764 class=n-a></a><td align=left colspan=10 rowspan=1><a name=d32386e1766 class=n-a></a><b>Group A</b></td></tr><tr><a name=d32386e1771 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1773 class=n-a></a>Our Unsupervised method</td><td align=center colspan=1 rowspan=1><a name=d32386e1776 class=n-a></a>0.6610</td><td align=center colspan=1 rowspan=1><a name=d32386e1779 class=n-a></a>1.4522</td><td align=center colspan=1 rowspan=1><a name=d32386e1782 class=n-a></a>0.6122</td><td align=center colspan=1 rowspan=1><a name=d32386e1785 class=n-a></a>0.6552</td><td align=center colspan=1 rowspan=1><a name=d32386e1789 class=n-a></a>1.3176</td><td align=center colspan=1 rowspan=1><a name=d32386e1792 class=n-a></a>0.6538</td><td align=center colspan=1 rowspan=1><a name=d32386e1795 class=n-a></a><b>0.6620</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1799 class=n-a></a>1.0166</td><td align=center colspan=1 rowspan=1><a name=d32386e1802 class=n-a></a><b>0.7928</b></td></tr><tr><a name=d32386e1807 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1809 class=n-a></a>Our Supervised method</td><td align=center colspan=1 rowspan=1><a name=d32386e1812 class=n-a></a>0.6730</td><td align=center colspan=1 rowspan=1><a name=d32386e1815 class=n-a></a><b>1.5463</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1819 class=n-a></a>0.5937</td><td align=center colspan=1 rowspan=1><a name=d32386e1822 class=n-a></a>0.6558</td><td align=center colspan=1 rowspan=1><a name=d32386e1826 class=n-a></a><b>1.3719</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1830 class=n-a></a><b>0.6731</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1834 class=n-a></a>0.6534</td><td align=center colspan=1 rowspan=1><a name=d32386e1837 class=n-a></a><b>1.0994</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1841 class=n-a></a>0.7807</td></tr><tr><a name=d32386e1845 class=n-a></a><td align=left colspan=10 rowspan=1><a name=d32386e1847 class=n-a></a><b>Group B</b></td></tr><tr><a name=d32386e1852 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1854 class=n-a></a>Random gene selection</td><td align=center colspan=1 rowspan=1><a name=d32386e1857 class=n-a></a>0.6736</td><td align=center colspan=1 rowspan=1><a name=d32386e1860 class=n-a></a>1.0638</td><td align=center colspan=1 rowspan=1><a name=d32386e1863 class=n-a></a><b>0.6289</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1867 class=n-a></a>0.6113</td><td align=center colspan=1 rowspan=1><a name=d32386e1871 class=n-a></a>0.6930</td><td align=center colspan=1 rowspan=1><a name=d32386e1874 class=n-a></a>0.6240</td><td align=center colspan=1 rowspan=1><a name=d32386e1877 class=n-a></a>0.5362</td><td align=center colspan=1 rowspan=1><a name=d32386e1880 class=n-a></a>0.5052</td><td align=center colspan=1 rowspan=1><a name=d32386e1883 class=n-a></a>0.7283</td></tr><tr><a name=d32386e1888 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1890 class=n-a></a>Random gene selection + neigh based reweighting</td><td align=center colspan=1 rowspan=1><a name=d32386e1893 class=n-a></a>0.6714</td><td align=center colspan=1 rowspan=1><a name=d32386e1896 class=n-a></a>1.4043</td><td align=center colspan=1 rowspan=1><a name=d32386e1899 class=n-a></a>0.5762</td><td align=center colspan=1 rowspan=1><a name=d32386e1902 class=n-a></a><b>0.6642</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1907 class=n-a></a>1.139</td><td align=center colspan=1 rowspan=1><a name=d32386e1910 class=n-a></a>0.6619</td><td align=center colspan=1 rowspan=1><a name=d32386e1913 class=n-a></a>0.5734</td><td align=center colspan=1 rowspan=1><a name=d32386e1916 class=n-a></a>0.6997</td><td align=center colspan=1 rowspan=1><a name=d32386e1919 class=n-a></a>0.6964</td></tr><tr><a name=d32386e1923 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1925 class=n-a></a>High degree gene selection</td><td align=center colspan=1 rowspan=1><a name=d32386e1928 class=n-a></a><b>0.6914</b></td><td align=center colspan=1 rowspan=1><a name=d32386e1932 class=n-a></a>0.904</td><td align=center colspan=1 rowspan=1><a name=d32386e1935 class=n-a></a>0.5860</td><td align=center colspan=1 rowspan=1><a name=d32386e1938 class=n-a></a>0.6061</td><td align=center colspan=1 rowspan=1><a name=d32386e1942 class=n-a></a>1.0163</td><td align=center colspan=1 rowspan=1><a name=d32386e1945 class=n-a></a>0.5969</td><td align=center colspan=1 rowspan=1><a name=d32386e1948 class=n-a></a>0.5653</td><td align=center colspan=1 rowspan=1><a name=d32386e1951 class=n-a></a>0.6156</td><td align=center colspan=1 rowspan=1><a name=d32386e1954 class=n-a></a>0.7159</td></tr><tr><a name=d32386e1958 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1960 class=n-a></a>High degree gene selection + neigh based reweighting</td><td align=center colspan=1 rowspan=1><a name=d32386e1963 class=n-a></a>0.6702</td><td align=center colspan=1 rowspan=1><a name=d32386e1966 class=n-a></a>1.3241</td><td align=center colspan=1 rowspan=1><a name=d32386e1969 class=n-a></a>0.5706</td><td align=center colspan=1 rowspan=1><a name=d32386e1972 class=n-a></a>0.6134</td><td align=center colspan=1 rowspan=1><a name=d32386e1976 class=n-a></a>1.027</td><td align=center colspan=1 rowspan=1><a name=d32386e1979 class=n-a></a>0.5978</td><td align=center colspan=1 rowspan=1><a name=d32386e1982 class=n-a></a>0.5593</td><td align=center colspan=1 rowspan=1><a name=d32386e1985 class=n-a></a>0.7065</td><td align=center colspan=1 rowspan=1><a name=d32386e1988 class=n-a></a>0.6468</td></tr><tr><a name=d32386e1992 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e1994 class=n-a></a>Avg of all metrics in group A for each subchallenge</td><td align=left colspan=1 rowspan=1><a name=d32386e1997 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e1999 class=n-a></a>0.9231</td><td align=left colspan=1 rowspan=1><a name=d32386e2002 class=n-a></a></td><td align=left colspan=1 rowspan=1><a name=d32386e2004 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e2007 class=n-a></a>0.8879</td><td align=left colspan=1 rowspan=1><a name=d32386e2010 class=n-a></a></td><td align=left colspan=1 rowspan=1><a name=d32386e2012 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e2014 class=n-a></a>0.8342</td><td align=left colspan=1 rowspan=1><a name=d32386e2017 class=n-a></a></td></tr><tr><a name=d32386e2020 class=n-a></a><td align=left colspan=1 rowspan=1><a name=d32386e2022 class=n-a></a>Avg of all metrics in group B for each subchallenge</td><td align=left colspan=1 rowspan=1><a name=d32386e2025 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e2027 class=n-a></a>0.8137</td><td align=left colspan=1 rowspan=1><a name=d32386e2030 class=n-a></a></td><td align=left colspan=1 rowspan=1><a name=d32386e2032 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e2035 class=n-a></a>0.7376</td><td align=left colspan=1 rowspan=1><a name=d32386e2038 class=n-a></a></td><td align=left colspan=1 rowspan=1><a name=d32386e2040 class=n-a></a></td><td align=center colspan=1 rowspan=1><a name=d32386e2042 class=n-a></a>0.6291</td><td align=left colspan=1 rowspan=1><a name=d32386e2045 class=n-a></a></td></tr></tbody></table></div><p class="" id=d32386e2051>The predictions mentioned above did not involve any additional pre-processing steps, e.g. imputation, on the provided input data. We simply used the binarized and normalized <i>in situ</i> hybridization and scRNA-seq data. However, for the sake of completeness we also examined the possible role of "imputation" and using raw data instead of the binarized scRNA-seq data. We tried to impute the dropouts in scRNA-seq data using SAVER<sup><a href="#ref-17">17</a></sup> and netImpute<sup><a href="#ref-18">18</a></sup>, but no significant improvement was gained in terms of enhancing our metric scores. On the other hand, although our analysis indicated that using raw data instead of the binarized data can potentially increase the consistency between gene expression pattern similarity and cell proximity in this challenge (according to <i>M</i><sub>1</sub> and <i>M</i><sub>2</sub> metrics), we are limited by the fact that the true locations of the cells to be predicted are unknown, and prediction accuracy is at least partially defined by comparing to the gold standard location obtained from binarized data. We speculate that anyone using raw data would probably be disadvantaged. It is noteworthy that our method is applicable if one prefers to use raw data instead of binarized data, and our results (data not shown; available as underlying data) indicate that there is benefit of using raw data instead of binarized data.</p></div><div class=section><a name=d32386e2077 class=n-a></a><h3 class=section-title>Robustness of marker genes</h3><p class="" id=d32386e2082>In the post-challenge phase of the competition the data set was divided into train and test subsets using 10-fold cross-validation in order to further investigate to what degree the set of most informative genes are consistent across different subset of cells selected through the 10 fold CV analysis. The results given in <a href="#f1">Figure 1</a> show that the Jaccard similarity between different folds are higher than the expected similarity in all three subchallenges indicating that there in fact exists a consistency in the most-informative genes selected across different folds. Moreover, as the number of genes allowed in a subchallenge decreases (from subchallenge 1 to subchallenge 3) the difference between Jaccard similarity of the most-informative genes and its expected value becomes more and more pronounced.</p><a name=f1 class=n-a></a><div class="fig panel clearfix"><a target=_blank href="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure1.gif"><img alt="b5125426-ef7c-4dbd-a593-916d2af184ac_figure1.gif" src="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure1.gif"></a><div class=caption><h3>Figure 1. Boxplot shows the Jaccard similarity between the genes selected for each of the 10 CV scheme in all 3 subchallenges.</h3><p id=d32386e2098>Blue stars represent expected Jaccard similarity.</p></div></div><p class="" id=d32386e2105><a href="#f2">Figure 2</a> shows the Venn diagram of 20 most informative genes selected from supervised and unsupervised methods. Out of 20 genes selected by each method, there are 11 common genes identified by both methods, which is more than expected (p-value &lt; 0.0005, Fishers exact test).</p><a name=f2 class=n-a></a><div class="fig panel clearfix"><a target=_blank href="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure2.gif"><img alt="b5125426-ef7c-4dbd-a593-916d2af184ac_figure2.gif" src="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure2.gif"></a><div class=caption><h3>Figure 2. The Venn diagram shows 20 genes selected from supervised and unsupervised methods out of which 11 genes are common for both methods.</h3><p id=d32386e2120>The 12 genes denoted by red color are the scRNA cluster-specific genes reported in DistMap.</p></div></div><p class="" id=d32386e2128>Another interesting observation is that cluster-specific genes (denoted by red color) are prevalent in the set of most informative genes obtained from both supervised and unsupervised methods. This finding highlights our method was in fact able to take advantage of those 12 cluster-specific genes which contain cell location information.</p></div><div class=section><a name=d32386e2132 class=n-a></a><h3 class=section-title>Recovering gene expression pattern</h3><p class="" id=d32386e2137>To virtually reconstruct gene expression patterns, the result of our method (i.e. bin-cell association matrix) was processed based on the methodology of vISH - a tool developed in <a href="#ref-15">15</a> to derive the expression pattern of each of the 84 genes across the location bins, and compared with the expression patterns obtained by DistMap. <a href="#f3">Figure 3</a> shows the distribution of the PCC between DistMap and our results from the three subchallenges. Overall, there is a high correlation among reference patterns (DistMap) and patterns generated by our method. The average correlation in the three sub-challenges are 0.81, 0.76, and 0.68, respectively. In sub-challenge 1, almost all genes have been reliably reconstructed, while for sub-challenge 3, a small number of genes have fairly low reconstruction rate.</p><a name=f3 class=n-a></a><div class="fig panel clearfix"><a target=_blank href="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure3.gif"><img alt="b5125426-ef7c-4dbd-a593-916d2af184ac_figure3.gif" src="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure3.gif"></a><div class=caption><h3>Figure 3. Histogram of correlation between gene patterns predicted by our method and DistMap using 60,40,20 genes.</h3></div></div><p class="" id=d32386e2160><a href="#f4">Figure 4</a> shows the reconstructed expression patterns for three genes: <i>twi</i>, <i>cad</i>, and <i>ftz</i>, which play key roles in the regulatory network of early <i>Drosophila</i> development. Overall, there is good agreement between our predictions and that of DistMap. In case of <i>twi</i>, our method and DistMap both very precisely predicted the <i>in situ</i> expression pattern. In fact, <i>twi</i> is one the 20 genes selected by both the supervised and unsupervised feature selection methods, due to its distinct expression patterns associated with cell spatial arrangement in the embryo. For <i>cad</i>, DistMap and our method with as few as 20 genes predicted very similar expression patterns, where there is a higher expression in the posterior domain, consistent with the current knowledge of cad in embryo development<sup><a href="#ref-19">19</a></sup>. On the other hand, the predicted expression patterns seem to be much more diffused than the <i>in situ</i> expression pattern, potentially because of the binarization of the <i>in situ</i> data, which caused loss of weaker signals. Finally, for <i>ftz</i>, while the predicted expression pattern by our method with 60 genes is in general agreement with DistMap and <i>in situ</i> data, our method with 40 or 20 genes failed to reconstruct the expression pattern of <i>ftz</i> associated with the segmentation of <i>Drosophila</i> embryos<sup><a href="#ref-20">20</a></sup>. While it is possible that more refined parameters such as a smaller number of neighbor cells may improve the prediction of our method, we believe the striped pattern of <i>ftz</i> makes it difficult, if not impossible, for any method that aims at a much reduced number of marker genes for spatial mapping.</p><a name=f4 class=n-a></a><div class="fig panel clearfix"><a target=_blank href="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure4.gif"><img alt="b5125426-ef7c-4dbd-a593-916d2af184ac_figure4.gif" src="https://f1000researchdata.s3.amazonaws.com/manuscripts/26653/b5125426-ef7c-4dbd-a593-916d2af184ac_figure4.gif"></a><div class=caption><h3>Figure 4. Expression pattern of three sample genes are given for <i>in situ</i>, DistMap, and our method using 60,40,20 genes.</h3></div></div></div></div><div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e2241>Conclusion</h2><p class="" id=d32386e2244>In this work, we proposed a method to identify gene markers for RNAseq-based reconstruction of cell spatial information that were lost during single-cell transcriptomics sequencing of <i>Drosophila</i> embryo. The main hypothesis of this study is that the topology of the marker gene expression based cell-cell similarity graph should be consistent with the topology of the cell-cell geometric location map. To test the hypothesis, several metrics were defined based on this biological rationale to capture the consistency between gene expression similarity and cell proximity. A greedy step-wise backward elimination feature selection algorithm was implemented to find a set of most informative genes to optimize these metrics. Next, a Particle Swarm Optimization algorithm was developed to obtain optimal gene weights to construct the cell-location association matrix. Finally, the prediction score of a cells location was further improved by considering the expression similarity between neighboring locations. It was shown that our method can successfully identify markers genes capable of predicting cell locations with high accuracy. In addition, it was also demonstrated that our method can recover the spatial expression patterns of most embryo marker genes. Even though the method proposed here was custom designed for this <i>Drosophila</i> embryo problem, it has the potential to be readily applied to other organisms as well.</p></div><div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e2256>Data availability</h2><div class=section><a name=d32386e2259 class=n-a></a><h3 class=section-title>Underlying data</h3><p class="" id=d32386e2264>The challenge datasets can be accessed at <a target=xrefwindow href="https://www.synapse.org/#!Synapse:syn16782375" id=d32386e2266>https://www.synapse.org/#!Synapse:syn16782375</a></p><p class="" id=d32386e2269>Challenge documentation, including the detailed description of the Challenge design, overall results, scoring scripts, and the clinical trials data dictionary can be found at: <a target=xrefwindow href="https://www.synapse.org/#!Synapse:syn15665609/wiki/582909" id=d32386e2271>https://www.synapse.org/#!Synapse:syn15665609/wiki/582909</a></p></div></div><div id=article1-body class=generated-article-body><h2 class=main-title id=d32386e2279>Software availability</h2><p class="" id=d32386e2282>Source code is available from: <a target=xrefwindow href="https://github.com/mary77/scSpatialMapping" id=d32386e2284>https://github.com/mary77/scSpatialMapping.git</a></p><p class="" id=d32386e2287>Archived source code at time of publication: <a target=xrefwindow href="https://doi.org/10.5281/zenodo.3877577" id=d32386e2289>https://doi.org/10.5281/zenodo.3877577</a><sup><a href="#ref-16">16</a></sup></p><p class="" id=d32386e2295>License: <a target=xrefwindow href="https://github.com/mary77/scSpatialMapping/blob/master/LICENSE" id=d32386e2297>MIT</a></p></div><div id=article1-back class=generated-article-footer><div class=back-section><a name=d32386e2304 class=n-a></a><span class="research-layout prime-recommended-wrapper reference-heading is-hidden"><span class="f1r-icon icon-79_faculty_recommended_badge red vmiddle default-cursor"></span><span class="prime-red big">F1000 recommended</span></span><h2 class=main-title id=d32600>References</h2><div class="section ref-list"><a name=d32386e2304 class=n-a></a><ul><li><a name=ref-1 class=n-a></a><span class=label>1. </span>&nbsp;<span class=citation><a name=d32386e2311 class=n-a></a>Kolodziejczyk AA, Kim JK, Svensson V, <i> et al.</i>: The Technology and Biology of Single-Cell RNA Sequencing. <i>Mol Cell.</i> 2015; <b>58</b>(4): 610620. <a target=xrefwindow id=d32386e2322 href="http://www.ncbi.nlm.nih.gov/pubmed/26000846">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2325 href="https://doi.org/10.1016/j.molcel.2015.04.005">Publisher Full Text </a></span></li><li><a name=ref-2 class=n-a></a><span class=label>2. </span>&nbsp;<span class=citation><a name=d32386e2334 class=n-a></a>Altschuler SJ, Wu LF: Cellular Heterogeneity: Do Differences Make a Difference? <i>Cell.</i> 2010; <b>141</b>(4): 559563. <a target=xrefwindow id=d32386e2342 href="http://www.ncbi.nlm.nih.gov/pubmed/20478246">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2345 href="https://doi.org/10.1016/j.cell.2010.04.033">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2348 href="http://www.ncbi.nlm.nih.gov/pmc/articles/2918286">Free Full Text </a></span></li><li><a name=ref-3 class=n-a></a><span class=label>3. </span>&nbsp;<span class=citation><a name=d32386e2357 class=n-a></a>Tang F, Barbacioru C, Wang Y, <i> et al.</i>: mRNA-Seq whole-transcriptome analysis of a single cell. <i>Nat Methods.</i> 2009; <b>6</b>(5): 377382. <a target=xrefwindow id=d32386e2368 href="http://www.ncbi.nlm.nih.gov/pubmed/19349980">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2371 href="https://doi.org/10.1038/nmeth.1315">Publisher Full Text </a></span></li><li><a name=ref-4 class=n-a></a><span class=label>4. </span>&nbsp;<span class=citation><a name=d32386e2380 class=n-a></a>Wang Z, Gerstein M, Snyder M: RNA-Seq: a revolutionary tool for transcriptomics. <i>Nat Rev Genet.</i> 2009; <b>10</b>(1): 5763. <a target=xrefwindow id=d32386e2388 href="http://www.ncbi.nlm.nih.gov/pubmed/19015660">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2391 href="https://doi.org/10.1038/nrg2484">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2394 href="http://www.ncbi.nlm.nih.gov/pmc/articles/2949280">Free Full Text </a></span></li><li><a name=ref-5 class=n-a></a><span class=label>5. </span>&nbsp;<span class=citation><a name=d32386e2403 class=n-a></a>Huang S: Non-genetic heterogeneity of cells in development: more than just noise. <i>Development.</i> 2009; <b>136</b>(23): 38533862. <a target=xrefwindow id=d32386e2411 href="http://www.ncbi.nlm.nih.gov/pubmed/19906852">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2414 href="https://doi.org/10.1242/dev.035139">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2417 href="http://www.ncbi.nlm.nih.gov/pmc/articles/2778736">Free Full Text </a></span></li><li><a name=ref-6 class=n-a></a><span class=label>6. </span>&nbsp;<span class=citation><a name=d32386e2427 class=n-a></a>Shalek AK, Satija R, Shuga J, <i> et al.</i>: Single-cell RNA-seq reveals dynamic paracrine control of cellular variation. <i>Nature.</i> 2014; <b>510</b>(7505): 363369. <a target=xrefwindow id=d32386e2438 href="http://www.ncbi.nlm.nih.gov/pubmed/24919153">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2441 href="https://doi.org/10.1038/nature13437">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2445 href="http://www.ncbi.nlm.nih.gov/pmc/articles/4193940">Free Full Text </a></span></li><li><a name=ref-7 class=n-a></a><span class=label>7. </span>&nbsp;<span class=citation><a name=d32386e2454 class=n-a></a>Wagner A, Regev A, Yosef N: Revealing the vectors of cellular identity with single-cell genomics. <i>Nat Biotechnol.</i> 2016; <b>34</b>(11): 11451160. <a target=xrefwindow id=d32386e2462 href="http://www.ncbi.nlm.nih.gov/pubmed/27824854">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2465 href="https://doi.org/10.1038/nbt.3711">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2468 href="http://www.ncbi.nlm.nih.gov/pmc/articles/5465644">Free Full Text </a></span></li><li><a name=ref-8 class=n-a></a><span class=label>8. </span>&nbsp;<span class=citation><a name=d32386e2477 class=n-a></a>Casasent AK, Schalck A, Gao R, <i> et al.</i>: Multiclonal Invasion in Breast Tumors Identified by Topographic Single Cell Sequencing. <i>Cell.</i> 2018; <b>172</b>(12): 205217.e12. <a target=xrefwindow id=d32386e2488 href="http://www.ncbi.nlm.nih.gov/pubmed/29307488">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2491 href="https://doi.org/10.1016/j.cell.2017.12.007">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2495 href="http://www.ncbi.nlm.nih.gov/pmc/articles/5766405">Free Full Text </a></span></li><li><a name=ref-9 class=n-a></a><span class=label>9. </span>&nbsp;<span class=citation><a name=d32386e2504 class=n-a></a>Sthl PL, Salmn F, Vickovic S, <i> et al.</i>: Visualization and analysis of gene expression in tissue sections by spatial transcriptomics. <i>Science.</i> 2016; <b>353</b>(6294): 7882. <a target=xrefwindow id=d32386e2515 href="http://www.ncbi.nlm.nih.gov/pubmed/27365449">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2518 href="https://doi.org/10.1126/science.aaf2403">Publisher Full Text </a></span></li><li><a name=ref-10 class=n-a></a><span class=label>10. </span>&nbsp;<span class=citation><a name=d32386e2527 class=n-a></a>Lovatt D, Ruble BK, Lee J, <i> et al.</i>: Transcriptome in vivo analysis (TIVA) of spatially defined single cells in live tissue. <i>Nat Methods.</i> 2014; <b>11</b>(2): 190196. <a target=xrefwindow id=d32386e2538 href="http://www.ncbi.nlm.nih.gov/pubmed/24412976">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2541 href="https://doi.org/10.1038/nmeth.2804">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2545 href="http://www.ncbi.nlm.nih.gov/pmc/articles/3964595">Free Full Text </a></span></li><li><a name=ref-11 class=n-a></a><span class=label>11. </span>&nbsp;<span class=citation><a name=d32386e2554 class=n-a></a>Rodriques SG, Stickels RR, Goeva A, <i> et al.</i>: Slide-seq: A scalable technology for measuring genome-wide expression at high spatial resolution. <i>Science.</i> 2019; <b>363</b>(6434): 14631467. <a target=xrefwindow id=d32386e2565 href="http://www.ncbi.nlm.nih.gov/pubmed/30923225">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2568 href="https://doi.org/10.1126/science.aaw1219">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2572 href="http://www.ncbi.nlm.nih.gov/pmc/articles/6927209">Free Full Text </a></span></li><li><a name=ref-12 class=n-a></a><span class=label>12. </span>&nbsp;<span class=citation><a name=d32386e2582 class=n-a></a>Oh SW, Harris JA, Ng L, <i> et al.</i>: A mesoscale connectome of the mouse brain. <i>Nature.</i> 2014; <b>508</b>(7495): 207214. <a target=xrefwindow id=d32386e2593 href="http://www.ncbi.nlm.nih.gov/pubmed/24695228">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2596 href="https://doi.org/10.1038/nature13186">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2600 href="http://www.ncbi.nlm.nih.gov/pmc/articles/5102064">Free Full Text </a></span></li><li><a name=ref-13 class=n-a></a><span class=label>13. </span>&nbsp;<span class=citation><a name=d32386e2609 class=n-a></a>Hawrylycz MJ, Lein ES, Guillozet-Bongaarts AL, <i> et al.</i>: An anatomically comprehensive atlas of the adult human brain transcriptome. <i>Nature.</i> 2012; <b>489</b>(7416): 391399. <a target=xrefwindow id=d32386e2620 href="http://www.ncbi.nlm.nih.gov/pubmed/22996553">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2623 href="https://doi.org/10.1038/nature11405">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2627 href="http://www.ncbi.nlm.nih.gov/pmc/articles/4243026">Free Full Text </a></span></li><li><a name=ref-14 class=n-a></a><span class=label>14. </span>&nbsp;<span class=citation><a name=d32386e2636 class=n-a></a>Satija R, Farrell JA, Gennert D, <i> et al.</i>: Spatial reconstruction of single-cell gene expression data. <i>Nat Biotechnol.</i> 2015; <b>33</b>(5): 495502. <a target=xrefwindow id=d32386e2647 href="http://www.ncbi.nlm.nih.gov/pubmed/25867923">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2650 href="https://doi.org/10.1038/nbt.3192">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2654 href="http://www.ncbi.nlm.nih.gov/pmc/articles/4430369">Free Full Text </a></span></li><li><a name=ref-15 class=n-a></a><span class=label>15. </span>&nbsp;<span class=citation><a name=d32386e2663 class=n-a></a>Karaiskos N, Wahle P, Alles J, <i> et al.</i>: The <i>Drosophila</i> embryo at single-cell transcriptome resolution. <i>Science.</i> 2017; <b>358</b>(6360): 194199. <a target=xrefwindow id=d32386e2677 href="http://www.ncbi.nlm.nih.gov/pubmed/28860209">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2681 href="https://doi.org/10.1126/science.aan3235">Publisher Full Text </a></span></li><li><a name=ref-16 class=n-a></a><span class=label>16. </span>&nbsp;<span class=citation><a name=d32386e2690 class=n-a></a>Zand M, Ruan J: mary77/scspatialmapping: First release of scspatialmapping. <i>Zenodo.</i> 2020. <a target=xrefwindow id=d32386e2695 href="http://www.doi.org/10.5281/zenodo.3877577">http://www.doi.org/10.5281/zenodo.3877577</a></span></li><li><a name=ref-17 class=n-a></a><span class=label>17. </span>&nbsp;<span class=citation><a name=d32386e2704 class=n-a></a>Huang M, Wang J, Torre E, <i> et al.</i>: SAVER: gene expression recovery for single-cell RNA sequencing. <i>Nat Methods.</i> 2018; <b>15</b>(7): 539542. <a target=xrefwindow id=d32386e2715 href="http://www.ncbi.nlm.nih.gov/pubmed/29941873">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2718 href="https://doi.org/10.1038/s41592-018-0033-z">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2722 href="http://www.ncbi.nlm.nih.gov/pmc/articles/6030502">Free Full Text </a></span></li><li><a name=ref-18 class=n-a></a><span class=label>18. </span>&nbsp;<span class=citation><a name=d32386e2732 class=n-a></a>Zand M, Ruan J: Network-based single-cell rna-seq data imputation enhances cell type identification. <i>Genes (Basel).</i> 2020; <b>11</b>(4): 377. <a target=xrefwindow id=d32386e2740 href="http://www.ncbi.nlm.nih.gov/pubmed/32244427">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2743 href="https://doi.org/10.3390/genes11040377">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2746 href="http://www.ncbi.nlm.nih.gov/pmc/articles/7230610">Free Full Text </a></span></li><li><a name=ref-19 class=n-a></a><span class=label>19. </span>&nbsp;<span class=citation><a name=d32386e2755 class=n-a></a>Stauber M, Lemke S, Schmidt-Ott U: Expression and regulation of caudal in the lower cyclorrhaphan fly megaselia. <i>Dev Genes Evol.</i> 2008; <b>218</b>(2): 8187. <a target=xrefwindow id=d32386e2763 href="http://www.ncbi.nlm.nih.gov/pubmed/18214532">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2766 href="https://doi.org/10.1007/s00427-008-0204-5">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2769 href="http://www.ncbi.nlm.nih.gov/pmc/articles/2757626">Free Full Text </a></span></li><li><a name=ref-20 class=n-a></a><span class=label>20. </span>&nbsp;<span class=citation><a name=d32386e2778 class=n-a></a>Lim B, Fukaya T, Heist T, <i> et al.</i>: Temporal dynamics of pair-rule stripes in living drosophila embryos. <i>Proc Natl Acad Sci U S A.</i> 2018; <b>115</b>(33): 83768381. <a target=xrefwindow id=d32386e2789 href="http://www.ncbi.nlm.nih.gov/pubmed/30061421">PubMed Abstract </a> | <a target=xrefwindow id=d32386e2792 href="https://doi.org/10.1073/pnas.1810430115">Publisher Full Text </a> | <a target=xrefwindow id=d32386e2796 href="http://www.ncbi.nlm.nih.gov/pmc/articles/6099890">Free Full Text </a></span></li></ul></div></div></div> </div> <div class=f1r-article-desk> <section class="o-box o-box--medium u-bg--2 u-mt--2"> <h4 class="u-mt--0 u-mb--2 t-h3 u-weight--md">Looking for the Open Peer Review Reports?</h4> <p class="u-mt--0 u-mb--0 t-h4">They can now be found at the top of the panel on the right, linked from the box entitled Open Peer Review. Choose the reviewer report you wish to read and click the 'read' link. You can also read all the peer review reports by <a target=_blank href="https://f1000research.com/articles/9-1014/v1/pdf?article_uuid=b1043569-6e44-43a5-8d67-9424018193c6">downloading the PDF</a>.</p> </section> </div> <div id=article-comments class="article-comments padding-bottom-20"> <div class=current-article-comment-section> <h2 class=main-title name=add-new-comment id=add-new-comment> <span class="research-layout f1r-article-mobile-inline valign-middle"> <span class="f1r-icon icon-104_comments size30"></span> </span> <span class=f1r-article-desk-inline>Comments on this article</span> <span class=f1r-article-mobile-inline>Comments (0)</span> <span class="f1r-article-mobile-inline float-right"> <span class="f1r-icon icon-14_more_small"></span> <span class="f1r-icon icon-10_less_small"></span> </span> </h2> </div> <div class="f1r-article-desk-inline referee-report-info-box referee-report-version-box"> Version 1 </div> <div class="f1r-article-mobile research-layout mobile-version-info padding-top-30"> <span class=mversion>VERSION 1</span> <span class=details>PUBLISHED 20 Aug 2020</span> <span class="article-pubinfo-mobile versions-section"> </span> </div> <div class="f1r-article-mobile research-layout margin-top-20 is-centered"> <a href="/login?originalPath=/articles/9-1014/v1&scrollTo=add-new-comment" class=register-report-comment-button data-test-id=add-comment_mob> <button class="primary orange extra-padding comment-on-this-report">ADD YOUR COMMENT</button> </a> </div> <a href="/login?originalPath=/articles/9-1014/v1&scrollTo=add-new-comment" class="f1r-article-desk register-report-comment-button" data-test-id=add-comment> <span class=contracted></span>Comment </a> </div> <div class="f1r-article-mobile margin-bottom-30"> <div class=contracted-details> <a href="#" class="contracted-details-label author-affiliations"><span class=contracted></span>Author details</a> <a href="#" class=section-title>Author details</a> <span class="f1r-icon icon-14_more_small section-control"></span> <span class="f1r-icon icon-10_less_small section-control"></span> <div class="expanded-details affiliations is-hidden"> Computer science, University of Texas at San Antonio, San Antonio, Texas, 78249, USA<br/> <p> <div class=margin-bottom> Maryam Zand <br/> <span>Roles: </span> Conceptualization, Data Curation, Formal Analysis, Investigation, Methodology, Validation, Visualization, Writing  Original Draft Preparation, Writing  Review & Editing </div> <div class=margin-bottom> Jianhua Ruan <br/> <span>Roles: </span> Conceptualization, Formal Analysis, Funding Acquisition, Methodology, Project Administration, Resources, Supervision, Writing  Original Draft Preparation, Writing  Review & Editing </div> </p> </div> </div> <div class=contracted-details> <a href="#" class=section-title>Article Versions (1)</a> <span class="f1r-icon icon-14_more_small section-control"></span> <span class="f1r-icon icon-10_less_small section-control"></span> <div class="expanded-details grant-information article-page is-hidden"> <div> <a href="https://f1000research.com/articles/9-1014/v1" title="Open version 1 of this article." class="" gahelper=1>version 1</a> <span class="article-pubinfo-mobile versions-section"> </span> </div> <div> Published: 20 Aug 2020, 9:1014 </div> <div class=""><a href="https://doi.org/10.12688/f1000research.24163.1">https://doi.org/10.12688/f1000research.24163.1</a></div> </div> </div> <div class=contracted-details> <a href="#" class=section-title> <span class="f1r-icon icon-100_open_access"></span> Copyright </a> <span class="f1r-icon icon-14_more_small section-control"></span> <span class="f1r-icon icon-10_less_small section-control"></span> <div class="expanded-details grant-information article-page is-hidden">  2020 Zand M and Ruan J. This is an open access article distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/" target=_blank data-test-id=box-licence-link>Creative Commons Attribution License</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. </div> </div> <div class="padding-top-30 research-layout"> <div class=article-toolbox-wrapper-mobile> <div class=article-tools-icon-mobile data-section=download> <span class="f1r-icon icon-76_download_file white"></span> </div> <div class="article-tools-icon-mobile mobile-metrics article-metrics-wrapper metrics-icon-wrapper" data-section=metrics data-version-id=26653 data-id=24163 data-downloads="" data-views="" data-scholar="10.12688/f1000research.24163.1" data-recommended="" data-f1r-ga-helper="Article Page Metrics (Mobile)"> <span class="f1r-icon icon-89_metrics white"></span> </div> <div class=article-tools-divider-mobile></div> <div class=article-tools-icon-mobile data-section=cite> <span class="f1r-icon icon-82_quote white"></span> </div> <div class="article-tools-icon-mobile " data-section=track> <span class="f1r-icon icon-90_track white"></span> </div> <div class=article-tools-divider-mobile></div> <div class=article-tools-icon-mobile data-section=share> <span class="f1r-icon icon-34_share white"></span> </div> <span class=article-toolbox-stretch></span> </div> <div class=article-toolbox-content-mobile> <div class="toolbox-section download"> <div class=toolbox-section-heading>Download</div> <div class=toolbox-section-content> <a href="https://f1000research.com/articles/9-1014/v1/pdf?article_uuid=b1043569-6e44-43a5-8d67-9424018193c6" title="Download PDF" class="no-decoration pdf-download-helper"> <span class="f1r-icon icon-102_download_pdf toolbox-section-icon"></span> </a> <div class=toolbox-section-option-divider>&nbsp;</div> <a id=mobile-download-xml class=no-decoration href="#" title="Download XML"> <span class="f1r-icon icon-103_download_xml toolbox-section-icon"></span> </a> </div> <div class=toolbox-section-divider></div> <div class=toolbox-section-heading>Export To</div> <div class=toolbox-section-content> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=WORKSPACE>Sciwheel</button> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=BIBTEX>Bibtex</button> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=ENDNOTE>EndNote</button> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=PROCITE>ProCite</button> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=REF_MANAGER>Ref. Manager (RIS)</button> <button class="primary no-fill orange-text-and-border mobile-export" data-etype=SENTE>Sente</button> </div> </div> <div class="toolbox-section metrics"> <div class="toolbox-section-heading no-top-border">metrics</div> <div class="toolbox-section-divider toolbox-section-divider--no-height"></div> <div class=article-metrics-pageinfo> <div class=c-article-metrics-table> <table class=c-article-metrics-table__table> <thead> <tr> <th></th> <th><span class=c-article-metrics-table__heading>Views</span></th> <th><span class=c-article-metrics-table__heading>Downloads</span></th> </tr> </thead> <tbody> <tr> <th class=c-article-metrics-table__row-heading><span class="c-article-metrics-table__platform u-platform--" data-test-id=metrics_platform_name_mob>F1000Research</span></th> <td class="c-article-metrics-table__value js-article-views-count" data-test-id=metrics_platform_views_mob>-</td> <td class="c-article-metrics-table__value js-article-downloads-count" data-test-id=metrics_platform_downloads_mob>-</td> </tr> <tr> <th class=c-article-metrics-table__row-heading> <span class="u-ib u-middle c-article-metrics-table__pmc" data-test-id=metrics_pmc_name_mob>PubMed Central</span> <div class="c-block-tip c-block-tip--centered c-article-metrics-table__tooltip c-block-tip--md-padding c-block-tip--small-arrow u-ib u-middle"> <button type=button class="u-black--medium u-black--high@hover u-ib u-middle c-button--icon c-button--text c-block-tip__toggle"><i class="material-icons c-button--icon__icon">info_outline</i></button> <div class=c-block-tip__content>Data from PMC are received and updated monthly.</div> </div> </th> <td class="c-article-metrics-table__value js-pmc-views-count" data-test-id=metrics_pmc_views_mob>-</td> <td class="c-article-metrics-table__value js-pmc-downloads-count" data-test-id=metrics_pmc_downloads_mob>-</td> </tr> </tbody> </table> </div> </div> <span class=metrics-citations-container> <div class=toolbox-section-divider></div> <div class="toolbox-section-heading u-mb--1">Citations</div> <div> <div class=toolbox-section-colsplit> <div class=citations-scopus-logo> <a href="" target=_blank class="is-hidden metrics-citation-icon" title="View full citation details at www.scopus.com"><i class="material-icons scopus-icon">open_in_new</i></a> </div> <div class="toolbox-section-count scopus"> <a href='' class='scopus-citation-link is-hidden' target=_blank title='View full citation details at www.scopus.com'>0</a> </div> </div> <div class=toolbox-section-colsplit> <div class="citations-pubmed-logo f1000research"> <a href="" target=_blank class="is-hidden metrics-citation-icon f1000research" title="View full citation details"><i class="material-icons scopus-icon">open_in_new</i></a> </div> <div class="toolbox-section-count pubmed"> <a href='' class='pubmed-citation-link is-hidden' target=_blank title='View full citation details'>0</a> </div> </div> <div class=toolbox-section-divider></div> <div class=toolbox-section-content> <div class="citations-scholar-logo f1000research"> <a href="" target=_blank class="is-hidden metrics-citation-icon google-scholar f1000research" title="View full citation details" data-scholar="10.12688/f1000research.24163.1"><i class="material-icons scopus-icon">open_in_new</i></a> </div> </div> </div> </span> <span class=metrics-details-container> <div class=toolbox-section-divider></div> <div class="toolbox-section-content altmetric-section"> <div class=altmetrics-image></div> <div class=altmetrics-more-link> <a href="" target=_blank class=f1r-standard-link>SEE MORE DETAILS</a> </div> <div class=altmetric-mobile-column-counts></div> <div class=altmetric-mobile-column-readers></div> <div class=toolbox-section-divider></div> </div> </span> </div> <div class="toolbox-section cite"> <div class="toolbox-section-heading no-top-border">CITE</div> <div class=toolbox-section-divider></div> <div class=toolbox-section-heading>how to cite this article</div> <div id=citation-copy-mobile class="toolbox-section-content text-content heading9 small" data-test-id=mob_copy-citation_text> Zand M and Ruan J. Spatial mapping of single cells in the <i>Drosophila</i> embryo from transcriptomic data based on topological consistency [version 1; peer review: awaiting peer review] <i>F1000Research</i> 2020, <b>9</b>:1014 (<a href="https://doi.org/10.12688/f1000research.24163.1" target=_blank>https://doi.org/10.12688/f1000research.24163.1</a>) </div> <div class=toolbox-section-divider></div> <div class="toolbox-section-content text-content heading9 small"> NOTE: <em>it is important to ensure the information in <b>square brackets after the title</b> is included in all citations of this article.</em> </div> <div class=toolbox-section-content> <button class="primary orange extra-padding copy-cite-article-mobile js-clipboard" data-clipboard-target="#citation-copy-mobile" title="Copy the current citation details." data-test-id=mob_copy-citation_button-mob>COPY CITATION DETAILS</button> </div> </div> <div class="toolbox-section track"> <div class="toolbox-section-heading no-top-border">track</div> <div class=toolbox-section-divider></div> <div class=toolbox-section-heading>receive updates on this article</div> <div class="toolbox-section-content padding-left-20 padding-right-20 heading9 small"> Track an article to receive email alerts on any updates to this article. </div> <div class=toolbox-section-content> <a data-article-id=24163 id=mobile-track-article-signin-24163 title="Receive updates on new activity such as publication of new versions, peer reviews or author responses." href="/login?originalPath=/trackArticle/24163?target=/articles/9-1014/v1"> <button class="primary orange extra-padding"> TRACK THIS ARTICLE </button> </a> </div> </div> <div class="toolbox-section share"> <div class="toolbox-section-heading no-top-border">Share</div> <div class=toolbox-section-divider></div> <div class=toolbox-section-content> <a target=_blank class="f1r-shares-icon-square f1r-shares-email" title="Email this article"></a> <a target=_blank class="f1r-shares-icon-square f1r-shares-twitter" title="Share on Twitter"></a> <a target=_blank class="f1r-shares-icon-square f1r-shares-facebook" title="Share on Facebook"></a> <a target=_blank class="f1r-shares-icon-square f1r-shares-linkedin" title="Share on LinkedIn"></a> <a target=_blank class="f1r-shares-icon-square f1r-shares-reddit" title="Share on Reddit"></a> <a target=_blank class="f1r-shares-icon-square f1r-shares-mendelay" title="Share on Mendeley"></a> <div class="email-article-wrapper email-article-version-container"> <div class=toolbox-section-divider></div> <script src='https://www.recaptcha.net/recaptcha/api.js'></script> <form class="recommend-version-form-mobile research-layout"> <p>All fields are required.</p> <input name=versionId type=hidden value=26653 /> <input name=articleId type=hidden value=24163 /> <input name=senderName class="form-input-field reg-form" value="" type=text placeholder="Your name"/> <input name=senderEmail class="form-input-field reg-form margin-top" value="" type=text placeholder="Your email address"/> <textarea name=recipientEmails class="form-textarea-field ninetynine-percent-wide margin-top no-resize" placeholder="Recipient email address(es) (comma delimited)"></textarea> <input class="form-input-field reg-form margin-top" name=subject type=text value="Interesting article on F1000Research" placeholder=Subject /> <textarea name=message class="form-textarea-field reg-form margin-top no-resize">I thought this article from F1000Research (https://f1000research.com) would be of interest to you.</textarea> <div class="g-recaptcha margin-top" data-sitekey=6LcHqxoUAAAAANP3_0TzpGG6qFvl4DhbUcuRzw7W></div> <input value="" name=captcha type=hidden /> <p>A full article citation will be automatically included.</p> <p><img class="ticker-email-article-details hidden" src="/img/ticker.gif" alt=loading /></p> <button class="secondary orange margin-bottom" data-test-id=version_share_email_send>SEND EMAIL</button> <div class="orange-message margin-bottom is-hidden" data-test-id=version_share_email_message></div> </form> </div> </div> </div> </div> </div> <a name=article-reports></a> <div id=article-reports class="u-mt--3 reports-comments no-divider"> <div class="current-referee-status no-border-and-margin "> <h2 class=main-title id=current-referee-status> <span class="research-layout f1r-article-mobile-inline valign-middle"> <span class="f1r-icon icon-85_peer_review size30"></span> </span> Open Peer Review <span class="f1r-article-mobile-inline float-right"> <span class="f1r-icon icon-14_more_small"></span> <span class="f1r-icon icon-10_less_small"></span> </span> </h2> <a name=current-referee-status></a> <div class=current-referee-status__content name=add-new-report-comment id=add-new-report-comment> Current Reviewer Status: <div class=f1r-article-desk-inline><em>AWAITING PEER REVIEW</em></div> <div class="f1r-article-mobile-inline float-right"><em>AWAITING PEER REVIEW</em></div> <span class="circle-icon-small to-right" data-window=about-referee-status title=Help>?</span> <span class="research-layout f1r-article-mobile"> <div class=mobile-ref-status-help> Key to Reviewer Statuses <span class=referee-status-pointer></span> <span class="view-control float-right">VIEW</span> <span class="view-control float-right is-hidden">HIDE</span> <div class=mobile-ref-status-help-content> <div class="cf margin-top"> <span class="f1r-icon icon-86_approved status-green smaller float-left margin-bottom-40 margin-right" title=Approved></span> <span class=title>Approved</span>The paper is scientifically sound in its current form and only minor, if any, improvements are suggested </div> <div class="cf margin-top"> <span class="f1r-icon icon-87_approved_reservations status-green smaller float-left margin-bottom-40 margin-right" title="Approved with Reservations"></span> <span class=title>Approved with reservations</span> A number of small changes, sometimes more significant revisions are required to address specific details and improve the papers academic merit. </div> <div class="cf margin-top"> <span class="f1r-icon icon-88_not_approved status-red small float-left margin-bottom-30 margin-right" title="Not Approved"></span> <span class=title>Not approved</span>Fundamental flaws in the paper seriously undermine the findings and conclusions </div> </div> </div> </span> </div> </div> </div> <div class="f1r-article-mobile research-layout"> <div class="mobile-sections-divider before-comments"></div> </div> <div id=article-comments class="article-comments padding-bottom-20"> <div class=current-article-comment-section> <h2 class=main-title name=add-new-comment id=add-new-comment> <span class="research-layout f1r-article-mobile-inline valign-middle"> <span class="f1r-icon icon-104_comments size30"></span> </span> <span class=f1r-article-desk-inline>Comments on this article</span> <span class=f1r-article-mobile-inline>Comments (0)</span> <span class="f1r-article-mobile-inline float-right"> <span class="f1r-icon icon-14_more_small"></span> <span class="f1r-icon icon-10_less_small"></span> </span> </h2> </div> <div class="f1r-article-desk-inline referee-report-info-box referee-report-version-box"> Version 1 </div> <div class="f1r-article-mobile research-layout mobile-version-info padding-top-30"> <span class=mversion>VERSION 1</span> <span class=details>PUBLISHED 20 Aug 2020</span> <span class="article-pubinfo-mobile versions-section"> </span> </div> <div class="f1r-article-mobile research-layout margin-top-20 is-centered"> <a href="/login?originalPath=/articles/9-1014/v1&scrollTo=add-new-comment" class=register-report-comment-button data-test-id=add-comment_mob> <button class="primary orange extra-padding comment-on-this-report">ADD YOUR COMMENT</button> </a> </div> <a href="/login?originalPath=/articles/9-1014/v1&scrollTo=add-new-comment" class="f1r-article-desk register-report-comment-button" data-test-id=add-comment> <span class=contracted></span>Comment </a> </div> </div> </div> <div id=article_main-column class="p-article__sidebar o-layout__item u-1/3 not-expanded js-article-sidebar"> <div class="o-tab p-article__column-toggle-container"> <button class="c-tab c-tab--left js-column-toggle p-article__column-toggle not-expanded " type=button data-target-main=article_main-column data-target-secondary=article_secondary-column><i class="c-tab__icon material-icons u-hide@expanded">keyboard_arrow_left</i><i class="c-tab__icon material-icons u-show@expanded">keyboard_arrow_right</i></button> </div> <div class=p-article__sidebar-content> <div class="p-article__sidebar-scroller js-article-sidebar-scroller"> <section class="p-article__sidebar-view js-article-sidebar-view js-article-sidebar-main u-pt u-pb--8" data-view=peer-review> <div class="o-layout o-layout--flush"> <div class="o-layout__item u-pl"> <h3 class="u-mt--0 u-mb--2 t-h3 u-weight--md u-pl" data-test-id=article_sidebar_heading>Open Peer Review</h3> </div> <div class=o-layout__item> <div class="p-article__sidebar-highlight u-mb--2"> <h4 class="u-mt--0 u-mb--0 u-ib u-middle t-h4 u-weight--md u-mr--1/2">Reviewer Status</h4> <div class="u-ib u-middle"><em>AWAITING PEER REVIEW</em></div> </div> </div> <section class="o-layout__item u-pl"> <div class=u-pl> <hr class="c-hr c-hr--low c-hr--md u-mb--3"> <h4 class="t-h3 u-weight--md u-mt--0 u-mb--2">Comments on this article</h4> <div class=u-mb--4> <p class="u-mt--0 u-mb--1 t-h4"><a class=p-article__color--light href="#article-comments">All Comments</a><span class=" u-ib u-ml--1/2 p-article__color--light">(0)</span></p> <a class=t-h4 href="/login?originalPath=/articles/9-1014/v1&scrollTo=add-new-comment" data-test-id=add-comment>Add a comment</a> </div> <hr class="c-hr c-hr--low c-hr--md u-mb--4"> <div class="research-layout f1r-article-desk"> <div class="heading6 c-ribbon-wrapper c-ribbon-wrapper--etoc f1000research "> <div class=c-ribbon-wrapper__body>Sign up for content alerts</div> </div> </div> <div class="research-layout sidebar-sign-up-form f1r-article-desk u-mb--4 "> <form class=js-email-alert-signup action="#" method=POST data-email=tocAlertWeekly> <input type=hidden name=isUserLoggedIn class=js-email-alert-signup-logged-in value=N /> <input type=hidden name=userId class=js-email-alert-signup-user-id value=""/> <input type=hidden name=frequency class=js-email-alert-signup-frequency value=WEEKLY /> <div class="o-actions o-actions--middle"> <div class=o-actions__primary> <input type=email name=emailAddress class="form-input-field js-email-alert-signup-address u-1/1 u-bb" required=required placeholder=Email /> </div> <div class=o-actions__secondary> <div class="_mdl-layout u-ml--1/2"> <button class="mdl-button mdl-js-button mdl-button--colored mdl-button--small mdl-button--filled js-email-alert-signup-submit">Sign Up</button> </div> </div> </div> </form> <div id=sidebar-sign-up-message class="section-text js-email-alert-signup-msg is-hidden">You are now signed up to receive this alert</div> </div> <section class=js-terms-container> <hr class="c-hr c-hr--low c-hr--md u-mb--3"> <h4 class="t-h3 u-weight--md u-mt--0 u-mb--1">Browse by related subjects</h4> <div class="article-subcontainer article-subcontainer--sidebar"> <ul class=js-terms-list></ul> </div> </section> </div> </section> </div> </section> </div> <script src="/js/shared_scripts/modal-dialogue.js"></script> <script src="/js/shared_scripts/read-more.js"></script> <script src="/js/article/article-router.js"></script> <script src="/js/article/article-sidebar.js"></script> <script src="/js/referee/new/referee_helpers.js"></script> <script src="/js/article/article-column-toggle.js"></script> </div> </div> </div> </main> <input type=hidden id=_articleVersionUrl value="https://f1000research.com/articles/9-1014/v1/"> <div class=research-help id=about-referee-status> <div class="research-layout research-help-content about-referee-status"> <span class="close-research-help dark-cross" title=Close></span> Alongside their report, reviewers assign a status to the article: <div class="cf research-help-row"> <span class="f1r-icon icon-86_approved status-green smaller" title=Approved></span> <span class=research-help-text>Approved - the paper is scientifically sound in its current form and only minor, if any, improvements are suggested</span> </div> <div class="cf research-help-row"> <span class="f1r-icon icon-87_approved_reservations status-green smaller" title="Approved with Reservations"></span> <span class=research-help-text>Approved with reservations - A number of small changes, sometimes more significant revisions are required to address specific details and improve the papers academic merit. </span> </div> <div class="cf research-help-row"> <span class="f1r-icon icon-88_not_approved status-red small" title="Not Approved"></span> <span class=research-help-text>Not approved - fundamental flaws in the paper seriously undermine the findings and conclusions</span> </div> </div> </div> <div id=datasets-info class=is-hidden> </div> <div class=article-interactive-content-container style="display: none;"> <a name=f-template class=n-a></a> <div class="interactive-content-wrapper padding-20"> <img src="" class=interactive-content-image title="Open the interactive image display"> <div class=interactive-content-title></div> <div class=interactive-content-text></div> <div class="f1r-article-desk interactive-content-ribbon" data-interactive-content-type=R-Script> <div class=interactive-content-label>Adjust parameters to alter display</div> <div class=interactive-content-button></div> </div> <div class="f1r-article-mobile mobile-interactive-note"> View on desktop for interactive features <img src="/img/icon/interactive_content.png" class="float-right margin-right-40"/> </div> <div class=clearfix></div> </div> </div> <div id=article-interactive-omero-container class=article-interactive-omero-container style="display: none;"> <div class=interactive-content-wrapper> <div class="interactive-omero-button omero-content" title="Open the interactive content window." data-interactive-content-type=Omero></div> <div class=has-interactive-content-image> <span class=box-arrow></span> <span class=box-middle>Includes Interactive Elements</span> <span class=box-end></span> </div> <div class="fig panel clearfix" style="margin: 0; padding-bottom: 20px;"> <a name=templatelink class=n-a></a> <a target=_blank href="" class=link-for-omero-image> <img src="" class=interactive-omero-image title="Open the image display window."> </a> <div class=caption> <div class=interactive-content-title></div> <div class=interactive-content-text></div> </div> <div class="is-hidden omero-image-list"></div> </div> <div class="f1r-article-mobile mobile-interactive-note omero"> View on desktop for interactive features <img src="/img/icon/interactive_content.png" class="float-right margin-right-40"/> </div> <div class=clearfix></div> </div> </div> <div class="add-comment-container shadow-box is-hidden" id=save-comment-container> <span id=save-comment-text class=intro-text>Edit comment</span> <textarea id=new-comment name=new-comment class="global-textarea comment margin-bottom margin-top"></textarea> <p><strong>Competing Interests</strong></p> <textarea id=new-competing-interests name=competing-interests class="global-textarea competing-interests margin-bottom check-xss"></textarea> <div class=clearfix></div> <button id=cancelComment type=button class="general-white-orange-button float-right no-background-button margin-left"> Cancel </button> <button id=save-comment-button commentId="" type=button class="general-white-orange-button float-right"> Save </button> <div class=clearfix></div> <div class="green-message margin-top is-hidden comment-is-saved">The comment has been saved.</div> <div class="red-message margin-top is-hidden comment-not-added">An error has occurred. Please try again.</div> <div class="red-message margin-top is-hidden comment-enter-text ucf">Your must enter a comment.</div> <div class="red-message margin-top is-hidden comment-references-error references">References error.</div> </div> <div class="modal-window-wrapper is-hidden"> <div id=conflicts-interests class="modal-window padding-20"> <div class=modal-window__content> <h2 class=h2-title>Competing Interests Policy</h2> <p> Provide sufficient details of any financial or non-financial competing interests to enable users to assess whether your comments might lead a reasonable person to question your impartiality. Consider the following examples, but note that this is not an exhaustive list: </p> <div class=heading5>Examples of 'Non-Financial Competing Interests'</div> <ol class="numbered-list no-padding"> <li class=standard-padding>Within the past 4 years, you have held joint grants, published or collaborated with any of the authors of the selected paper.</li> <li class=standard-padding>You have a close personal relationship (e.g. parent, spouse, sibling, or domestic partner) with any of the authors.</li> <li class=standard-padding>You are a close professional associate of any of the authors (e.g. scientific mentor, recent student).</li> <li class=standard-padding>You work at the same institute as any of the authors.</li> <li class=standard-padding>You hope/expect to benefit (e.g. favour or employment) as a result of your submission.</li> <li class=standard-padding>You are an Editor for the journal in which the article is published.</li> </ol> <div class="heading5 padding-top">Examples of 'Financial Competing Interests'</div> <ol class="numbered-list no-padding"> <li class=standard-padding>You expect to receive, or in the past 4 years have received, any of the following from any commercial organisation that may gain financially from your submission: a salary, fees, funding, reimbursements.</li> <li class=standard-padding>You expect to receive, or in the past 4 years have received, shared grant support or other funding with any of the authors.</li> <li class=standard-padding>You hold, or are currently applying for, any patents or significant stocks/shares relating to the subject matter of the paper you are commenting on.</li> </ol> </div> <div class="f1r-article-mobile research-layout"> <span class=modal-window-close-button></span> </div> </div> </div> <div class="o-modal c-email-alert-popup js-email-alert-popup is-hidden"> <div class="o-modal__body js-modal-body c-email-alert-popup__inner"> <h3 class=c-email-alert-popup__title>Stay Updated</h3> <p class=c-email-alert-popup__sub>Sign up for content alerts and receive a weekly or monthly email with all newly published articles</p> <p><a href="/register?originalPath=" class="c-email-alert-popup__lnk c-email-alert-popup__button js-email-alert-popup-action">Register with F1000Research</a></p> <p>Already registered? <a href="/login?originalPath=" class="c-email-alert-popup__lnk js-email-alert-popup-action">Sign in</a></p> <p class=c-email-alert-popup__footer><a class="c-email-alert-popup__lnk js-email-alert-popup-cancel" href="#">Not now, thanks</a></p> </div> </div> <div id=addCommentModal role=dialog aria-labelledby=addCommentModal_title aria-describedby=addCommentModal_description> <div class="c-modal js-modal is-closed p-article__add-comment-modal c-modal--xlarge js-article-comment-modal c-modal--scroll "> <aside class="c-modal__content u-black--high o-box u-pb--0 u-bg--2 c-modal--scroll-always "> <div class=c-modal__close> <button type=button class="c-button c-button--icon c-button--medium c-button--full@hover js-modal__close"><i class="c-button--icon__icon material-icons">close</i></button> </div> <div id=addCommentModal_description class="c-modal__description js-modal__content t-h4 u-mt--0 u-mb--2 u-black--medium"> <div class="js-add-comment-container t-caption u-black--high"> <div class=u-weight--bd>PLEASE NOTE</div> <div class=u-mt--1> <span class="red u-weight--bd">If you are an AUTHOR of this article,</span> please check that you signed in with the account associated with this article otherwise we cannot automatically identify your role as an author and your comment will be labelled as a &ldquo;User Comment&rdquo;. </div> <div class=u-mt--1> <span class="red u-weight--bd">If you are a REVIEWER of this article,</span> please check that you have signed in with the account associated with this article and then go to your <a href="/my/referee">account</a> to submit your report, please do not post your review here. </div> <div class="u-mt--1 u-mb--1"> If you do not have access to your original account, please <a href="mailto:research@f1000.com">contact us</a>. </div> <p class=no-top-margin>All commenters must hold a formal affiliation as per our <a href="/about/policies#commentspolicy" target=_blank>Policies</a>. The information that you give us will be displayed next to your comment.</p> <p>User comments must be in English, comprehensible and relevant to the article under discussion. We reserve the right to remove any comments that we consider to be inappropriate, offensive or otherwise in breach of the <a href="/about/legal/usercommenttermsandconditions" target=_blank>User Comment Terms and Conditions</a>. Commenters must not use a comment for personal attacks. When criticisms of the article are based on unpublished data, the data should be made available.</p> <div class="comments-note margin-bottom" id=accept-user-comments> <input class=js-add-comment-accept-terms type=checkbox id=acceptedTermsAndConditions name=acceptedTermsAndConditions> I accept the <a href="/about/legal/usercommenttermsandconditions" target=_blank> User Comment Terms and Conditions</a> <span class=required>&nbsp;</span> </div> <div class="default-error margin-top is-hidden comment-accept-conditions utac">Please confirm that you accept the User Comment Terms and Conditions.</div> <div class="research-layout registration-form u-mb--2"> <div class="u-mb--1 u-mt--2"> <strong>Affiliation</strong> </div> <div class=form-field> <input type=text name=institution class="form-input-field check-xss js-add-comment-institution" placeholder="Organization *" autocomplete=off /> <div class="default-error margin-top is-hidden comment-enter-institution institution">Please enter your organisation.</div> </div> <div class=form-field> <input type=text name=place class="form-input-field check-xss js-add-comment-place" placeholder=Place> </div> <div class=form-field> <div class="form-input-wrapper hundred-percent-wide"> <div class="new-select-standard-wrapper half-width inline-display heading10"> <select name=countryId id=country class="form-select-menu smaller js-add-comment-country"> <option value=-1>Country*</option> <option value=840>USA</option> <option value=826>UK</option> <option value=124>Canada</option> <option value=156>China</option> <option value=250>France</option> <option value=276>Germany</option> <optgroup label=-----------------------------------------------></optgroup> <option value=4>Afghanistan</option> <option value=248>Aland Islands</option> <option value=8>Albania</option> <option value=12>Algeria</option> <option value=16>American Samoa</option> <option value=20>Andorra</option> <option value=24>Angola</option> <option value=660>Anguilla</option> <option value=10>Antarctica</option> <option value=28>Antigua and Barbuda</option> <option value=32>Argentina</option> <option value=51>Armenia</option> <option value=533>Aruba</option> <option value=36>Australia</option> <option value=40>Austria</option> <option value=31>Azerbaijan</option> <option value=44>Bahamas</option> <option value=48>Bahrain</option> <option value=50>Bangladesh</option> <option value=52>Barbados</option> <option value=112>Belarus</option> <option value=56>Belgium</option> <option value=84>Belize</option> <option value=204>Benin</option> <option value=60>Bermuda</option> <option value=64>Bhutan</option> <option value=68>Bolivia</option> <option value=70>Bosnia and Herzegovina</option> <option value=72>Botswana</option> <option value=74>Bouvet Island</option> <option value=76>Brazil</option> <option value=86>British Indian Ocean Territory</option> <option value=92>British Virgin Islands</option> <option value=96>Brunei</option> <option value=100>Bulgaria</option> <option value=854>Burkina Faso</option> <option value=108>Burundi</option> <option value=116>Cambodia</option> <option value=120>Cameroon</option> <option value=124>Canada</option> <option value=132>Cape Verde</option> <option value=136>Cayman Islands</option> <option value=140>Central African Republic</option> <option value=148>Chad</option> <option value=152>Chile</option> <option value=156>China</option> <option value=162>Christmas Island</option> <option value=166>Cocos (Keeling) Islands</option> <option value=170>Colombia</option> <option value=174>Comoros</option> <option value=178>Congo</option> <option value=184>Cook Islands</option> <option value=188>Costa Rica</option> <option value=384>Cote d'Ivoire</option> <option value=191>Croatia</option> <option value=192>Cuba</option> <option value=196>Cyprus</option> <option value=203>Czech Republic</option> <option value=180>Democratic Republic of the Congo</option> <option value=208>Denmark</option> <option value=262>Djibouti</option> <option value=212>Dominica</option> <option value=214>Dominican Republic</option> <option value=218>Ecuador</option> <option value=818>Egypt</option> <option value=222>El Salvador</option> <option value=226>Equatorial Guinea</option> <option value=232>Eritrea</option> <option value=233>Estonia</option> <option value=231>Ethiopia</option> <option value=238>Falkland Islands</option> <option value=234>Faroe Islands</option> <option value=583>Federated States of Micronesia</option> <option value=242>Fiji</option> <option value=246>Finland</option> <option value=250>France</option> <option value=254>French Guiana</option> <option value=258>French Polynesia</option> <option value=260>French Southern Territories</option> <option value=266>Gabon</option> <option value=268>Georgia</option> <option value=276>Germany</option> <option value=288>Ghana</option> <option value=292>Gibraltar</option> <option value=300>Greece</option> <option value=304>Greenland</option> <option value=308>Grenada</option> <option value=312>Guadeloupe</option> <option value=316>Guam</option> <option value=320>Guatemala</option> <option value=831>Guernsey</option> <option value=324>Guinea</option> <option value=624>Guinea-Bissau</option> <option value=328>Guyana</option> <option value=332>Haiti</option> <option value=334>Heard Island and Mcdonald Islands</option> <option value=336>Holy See (Vatican City State)</option> <option value=340>Honduras</option> <option value=344>Hong Kong</option> <option value=348>Hungary</option> <option value=352>Iceland</option> <option value=356>India</option> <option value=360>Indonesia</option> <option value=364>Iran</option> <option value=368>Iraq</option> <option value=372>Ireland</option> <option value=376>Israel</option> <option value=380>Italy</option> <option value=388>Jamaica</option> <option value=392>Japan</option> <option value=832>Jersey</option> <option value=400>Jordan</option> <option value=398>Kazakhstan</option> <option value=404>Kenya</option> <option value=296>Kiribati</option> <option value=901>Kosovo (Serbia and Montenegro)</option> <option value=414>Kuwait</option> <option value=417>Kyrgyzstan</option> <option value=418>Lao People's Democratic Republic</option> <option value=428>Latvia</option> <option value=422>Lebanon</option> <option value=426>Lesotho</option> <option value=430>Liberia</option> <option value=434>Libya</option> <option value=438>Liechtenstein</option> <option value=440>Lithuania</option> <option value=442>Luxembourg</option> <option value=446>Macao</option> <option value=807>Macedonia</option> <option value=450>Madagascar</option> <option value=454>Malawi</option> <option value=458>Malaysia</option> <option value=462>Maldives</option> <option value=466>Mali</option> <option value=470>Malta</option> <option value=584>Marshall Islands</option> <option value=474>Martinique</option> <option value=478>Mauritania</option> <option value=480>Mauritius</option> <option value=175>Mayotte</option> <option value=484>Mexico</option> <option value=581>Minor Outlying Islands of the United States</option> <option value=498>Moldova</option> <option value=492>Monaco</option> <option value=496>Mongolia</option> <option value=499>Montenegro</option> <option value=500>Montserrat</option> <option value=504>Morocco</option> <option value=508>Mozambique</option> <option value=104>Myanmar</option> <option value=516>Namibia</option> <option value=520>Nauru</option> <option value=524>Nepal</option> <option value=530>Netherlands Antilles</option> <option value=540>New Caledonia</option> <option value=554>New Zealand</option> <option value=558>Nicaragua</option> <option value=562>Niger</option> <option value=566>Nigeria</option> <option value=570>Niue</option> <option value=574>Norfolk Island</option> <option value=580>Northern Mariana Islands</option> <option value=408>North Korea</option> <option value=578>Norway</option> <option value=512>Oman</option> <option value=586>Pakistan</option> <option value=585>Palau</option> <option value=275>Palestinian Territory</option> <option value=591>Panama</option> <option value=598>Papua New Guinea</option> <option value=600>Paraguay</option> <option value=604>Peru</option> <option value=608>Philippines</option> <option value=612>Pitcairn</option> <option value=616>Poland</option> <option value=620>Portugal</option> <option value=630>Puerto Rico</option> <option value=634>Qatar</option> <option value=638>Reunion</option> <option value=642>Romania</option> <option value=643>Russian Federation</option> <option value=646>Rwanda</option> <option value=654>Saint Helena</option> <option value=659>Saint Kitts and Nevis</option> <option value=662>Saint Lucia</option> <option value=666>Saint Pierre and Miquelon</option> <option value=670>Saint Vincent and the Grenadines</option> <option value=882>Samoa</option> <option value=674>San Marino</option> <option value=678>Sao Tome and Principe</option> <option value=682>Saudi Arabia</option> <option value=686>Senegal</option> <option value=688>Serbia</option> <option value=690>Seychelles</option> <option value=694>Sierra Leone</option> <option value=702>Singapore</option> <option value=703>Slovakia</option> <option value=705>Slovenia</option> <option value=90>Solomon Islands</option> <option value=706>Somalia</option> <option value=710>South Africa</option> <option value=239>South Georgia and the South Sandwich Is</option> <option value=410>South Korea</option> <option value=724>Spain</option> <option value=144>Sri Lanka</option> <option value=736>Sudan</option> <option value=740>Suriname</option> <option value=744>Svalbard and Jan Mayen</option> <option value=748>Swaziland</option> <option value=752>Sweden</option> <option value=756>Switzerland</option> <option value=760>Syria</option> <option value=158>Taiwan</option> <option value=762>Tajikistan</option> <option value=834>Tanzania</option> <option value=764>Thailand</option> <option value=270>The Gambia</option> <option value=528>The Netherlands</option> <option value=626>Timor-Leste</option> <option value=768>Togo</option> <option value=772>Tokelau</option> <option value=776>Tonga</option> <option value=780>Trinidad and Tobago</option> <option value=788>Tunisia</option> <option value=792>Turkey</option> <option value=795>Turkmenistan</option> <option value=796>Turks and Caicos Islands</option> <option value=798>Tuvalu</option> <option value=800>Uganda</option> <option value=826>UK</option> <option value=804>Ukraine</option> <option value=784>United Arab Emirates</option> <option value=850>United States Virgin Islands</option> <option value=858>Uruguay</option> <option value=840>USA</option> <option value=860>Uzbekistan</option> <option value=548>Vanuatu</option> <option value=862>Venezuela</option> <option value=704>Vietnam</option> <option value=876>Wallis and Futuna</option> <option value=905>West Bank and Gaza Strip</option> <option value=732>Western Sahara</option> <option value=887>Yemen</option> <option value=894>Zambia</option> <option value=716>Zimbabwe</option> </select> </div> </div> <div class="default-error margin-top is-hidden comment-enter-country country">Please select your country.</div> </div> </div> <textarea data-test-id=article_add-comment_comment name=new-comment class="js-add-comment-comment comment margin-bottom margin-top"></textarea> <div class="default-error margin-top comment-enter-text comment-error is-hidden ">You must enter a comment.</div> <label class="comments-note u-mt--2 u-mb--2" for=competingInterests_1> <div class="u-mb--1 u-mt--2"><strong data-test-id=article_report-add-comment_competing-interests-title>Competing Interests</strong></div> <p class="u-mb--2 u-mt--0" data-test-id=article_report-add-comment_competing-interests-description>Please disclose any <a href="#article-competing-intersts-policy" class=js-modal-competing-intersts-toggle>competing interests</a> that might be construed to influence your judgment of the article's or peer review report's validity or importance.</p> </label> <div id=article-competing-intersts-policy class=js-article-competing-interests-policy style="display: none;"> <h2 class="h2-title u-mt--0 u-pt--0">Competing Interests Policy</h2> <p> Provide sufficient details of any financial or non-financial competing interests to enable users to assess whether your comments might lead a reasonable person to question your impartiality. Consider the following examples, but note that this is not an exhaustive list: </p> <div class=heading5>Examples of 'Non-Financial Competing Interests'</div> <ol class="numbered-list no-padding"> <li class=standard-padding>Within the past 4 years, you have held joint grants, published or collaborated with any of the authors of the selected paper.</li> <li class=standard-padding>You have a close personal relationship (e.g. parent, spouse, sibling, or domestic partner) with any of the authors.</li> <li class=standard-padding>You are a close professional associate of any of the authors (e.g. scientific mentor, recent student).</li> <li class=standard-padding>You work at the same institute as any of the authors.</li> <li class=standard-padding>You hope/expect to benefit (e.g. favour or employment) as a result of your submission.</li> <li class=standard-padding>You are an Editor for the journal in which the article is published.</li> </ol> <div class="heading5 padding-top">Examples of 'Financial Competing Interests'</div> <ol class="numbered-list no-padding"> <li class=standard-padding>You expect to receive, or in the past 4 years have received, any of the following from any commercial organisation that may gain financially from your submission: a salary, fees, funding, reimbursements.</li> <li class=standard-padding>You expect to receive, or in the past 4 years have received, shared grant support or other funding with any of the authors.</li> <li class=standard-padding>You hold, or are currently applying for, any patents or significant stocks/shares relating to the subject matter of the paper you are commenting on.</li> </ol> </div> <div id=competingInterests_1 class="c-inline-editor js-inline-editor js-form_input u-bb--all u-mb--2 js-comment-competing-interests" data-name=competing-interests data-rows=3> <textarea id=competingInterests_1_input name=competing-interests placeholder="&nbsp;" required=false class="u-hide-visually js-inline-editor_input" tabindex=-1></textarea> <div class="c-inline-editor__editor js-inline-editor_editor o-box c-box o-box--tiny u-bg--11" data-target=competingInterests_1_input role=textbox required=false data-placeholder="&nbsp;" contenteditable=true></div> <span class="c-inline-editor__error js-inline-editor-message">Please state your competing interests</span> </div> <div data-test-id=article_add-comment_saved class="green-message comments is-hidden comment-is-saved">The comment has been saved.</div> <div data-test-id=article_add-comment_error class="default-error comments is-hidden comment-not-added">An error has occurred. Please try again.</div> <div class=clearfix></div> <div class=js-hook></div> </div> <div class="c-modal__extra-message js-modal__extra-message t-h4 u-black--medium"></div></div> <div class="c-modal__actions o-box__actions"> <a href="#" data-test-id=article_add-comment_cancel class="c-button c-button--full js-modal__close c-button--secondary">Cancel</a> <a href="#" data-test-id=article_add-comment_post class="c-button c-button--full js-modal__confirm c-button--primary">Post</a> </div> </aside> </div> </div> <style>
                .at-icon-wrapper {
        background-size: 100% !important;
    }
</style> <script src="/js/namespace.js"></script> <script src="/js/constants.js"></script> <script src="/js/utilities.js"></script> <script src="/js/article/alert-signup.js"></script> <script type='text/javascript'>
    var lTitle = "Spatial mapping of single cells in the Drosophila...".replace("'", '');
    var linkedInUrl = "http://www.linkedin.com/shareArticle?url=https://f1000research.com/articles/9-1014/v1" + "&title=" + encodeURIComponent(lTitle) + "&summary=" + encodeURIComponent('Read the article by ');

    var deliciousUrl = "https://del.icio.us/post?url=https://f1000research.com/articles/9-1014/v1&title=" + encodeURIComponent(lTitle);

    var redditUrl = "http://reddit.com/submit?url=https://f1000research.com/articles/9-1014/v1" + "&title=" + encodeURIComponent(lTitle);

            linkedInUrl += encodeURIComponent('Zand M and Ruan J');
    
    var offsetTop = /chrome/i.test( navigator.userAgent ) ? 4 : -10; 
    var addthis_config = {
            ui_offset_top: offsetTop,
                                    services_compact : "facebook,twitter,www.linkedin.com,www.mendeley.com,reddit.com",
            services_expanded : "facebook,twitter,www.linkedin.com,www.mendeley.com,reddit.com",
            services_custom : [
                {
                    name: "LinkedIn",
                    url:  linkedInUrl,
                    icon:"/img/icon/at_linkedin.svg"
                },
                {
                    name: "Mendeley",
                    url:  "http://www.mendeley.com/import/?url=https://f1000research.com/articles/9-1014/v1/mendeley",
                    icon:"/img/icon/at_mendeley.svg"
                },
                {
                    name: "Reddit",
                    url:  redditUrl,
                    icon:"/img/icon/at_reddit.svg"
                },
            ]
        };


    var addthis_share = {
            url: "https://f1000research.com/articles/9-1014",
            templates : {
                twitter : "Spatial mapping of single cells in the Drosophila embryo from.... Zand M and Ruan J, published by " + 
               "@F1000Research"
       + ", https://f1000research.com/articles/9-1014/v1"
            }
        };

    if (typeof(addthis) != "undefined"){
        addthis.addEventListener('addthis.ready', checkCount);
        addthis.addEventListener('addthis.menu.share', checkCount);
    }

        $(".f1r-shares-twitter").attr("href", "https://twitter.com/intent/tweet?text=" + addthis_share.templates.twitter);
    $(".f1r-shares-facebook").attr("href", "https://www.facebook.com/sharer/sharer.php?u=" + addthis_share.url);
    $(".f1r-shares-linkedin").attr("href", addthis_config.services_custom[0].url);
    $(".f1r-shares-reddit").attr("href", addthis_config.services_custom[2].url);
    $(".f1r-shares-mendelay").attr("href", addthis_config.services_custom[1].url);

    function checkCount(){
        setTimeout(function(){
            $(".addthis_button_expanded").each(function(){
                var count = $(this).text();
                if (count !== "" && count != "0")
                    $(this).removeClass("is-hidden");
                else
                    $(this).addClass("is-hidden");
            });
        }, 1000);
    }
</script> <div id=citeReportModal role=dialog aria-labelledby=citeReportModal_title aria-describedby=citeReportModal_description> <div class="c-modal js-modal is-closed c-modal--large js-cite-report-modal "> <aside class="c-modal__content u-black--high o-box u-pb--0 u-black--high "> <div class=c-modal__close> <button type=button class="c-button c-button--icon c-button--medium c-button--full@hover js-modal__close"><i class="c-button--icon__icon material-icons">close</i></button> </div> <h1 id=citeReportModal_title class="c-modal__title t-h3 u-mt--0 u-mb--2 u-weight--md">How to cite this report</h1> <div id=citeReportModal_description class="c-modal__description js-modal__content t-h4 u-mt--0 u-mb--2 u-black--medium"> <div id="" class=js-report-citation-container>{{reportCitation}}</div> <div class="c-modal__extra-message js-modal__extra-message t-h4 u-black--medium"></div></div> <div class="c-modal__actions o-box__actions"> <a href="#" class="c-button c-button--full js-modal__close c-button--secondary">Cancel</a> <a href="#" title="Copy the current citation details to the clipboard." data-clipboard-target="#referee-report-citation" data-test-id=report_copy-citation_button class="c-button c-button--full js-modal__confirm c-button--primary js-clipboard c-mini-tooltip--above">Copy Citation Details</a> </div> </aside> </div> </div> <script src="/js/referee/new/referee_validators.js"></script> <script src="/js/referee/new/referee_helpers.js"></script> <script src="/js/referee/new/referee_checkbox-input.js"></script> <script src="/js/referee/new/referee_inline-editor.js"></script> <script type="text/javascript">
    $(function(){
        var gaCat = "F1000Research";
        if (gaCat === "") {
            gaCat = $("body").hasClass("wellcome-brand") ? "Wellcome Open Research" : "F1000Research";
        }
        GAHelper.track({category: gaCat, action: "Article Page: Spatial mapping of single cells in the Drosophila embryo from transcriptomic data based on topological consistency", label: "pageviews"});
        GAHelper.track({category: gaCat, action: "Article Type: Method Article", label: "Article Page"});
        $(".f1r-article-desk .collection-image").each(function (idx, el) {
            var whatChannel = $(el).find("a").attr("href"),
                channelName = $.trim($(el).parent().find(".collection-detail a").text()),
                gaRef = "(ID: " + whatChannel.replace("/collections/", "") + ") " + channelName;
            GAHelper.track({category: 'ChannelStats', action: "Article Page: Spatial mapping of single cells in the Drosophila embryo from transcriptomic data based on topological consistency", label: gaRef});
        });
    });
</script> <script>
    $(function(){R.ui.buttonDropdowns('.dropdown-for-downloads');});
    $(function(){R.ui.toolbarDropdowns('.toolbar-dropdown-for-downloads');});
</script> <script src="/js/article/track_article.js" type="text/javascript"></script> <script type="text/javascript">
    $.get("/articles/acj/24163/26653")
</script> <script type="text/javascript" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script type="text/javascript" src="/js/app/messenger.js"></script> <script type="text/javascript" src="/js/article/article_mobiles.js"></script> <script src="/js/vendor/clipboard.min.js"></script> <script src="/js/shared_scripts/modal-dialogue.js"></script> <script src="/js/shared_scripts/clipboard.js"></script> <script src="/js/article/thesaurus-terms-display.js"></script> <script>
    new F1000.Clipboard();
    new F1000.ThesaurusTermsDisplay("articles", "article", "26653");
</script> <script>
    $(document).ready(function() {
        $( "#frame1" ).on('load', function() {
            var mydiv = $(this).contents().find("div");
            var h     = mydiv.height();
            console.log(h)
        });

        
        var tooltipLivingFigure = jQuery(".interactive-living-figure-label .icon-more-info"),
            titleLivingFigure = tooltipLivingFigure.attr("title");
        tooltipLivingFigure.simpletip({
            fixed: true,
            position: ["-115", "30"],
            baseClass: 'small-tooltip',
            content:titleLivingFigure + "<div class='tooltip-arrow'></div>"
        });
        tooltipLivingFigure.removeAttr("title");

        $("body").on("click", ".cite-living-figure", function(e) {
            e.preventDefault();
            var ref = $(this).attr("data-ref");
            $(this).closest(".living-figure-list-container").find("#" + ref).fadeIn(200);
        });
        $("body").on("click", ".close-cite-living-figure", function(e) {
            e.preventDefault();
            $(this).closest(".popup-window-wrapper").fadeOut(200);
        });

                $(document).on("mouseup", function(e) {
            var metricsContainer = $(".article-metrics-popover-wrapper");
            if (!metricsContainer.is(e.target) && metricsContainer.has(e.target).length === 0) {
                $(".article-metrics-close-button").click();
            }
        });

        var articleId = $('#articleId').val();

        if($("#main-article-count-box").attachArticleMetrics) {
            $("#main-article-count-box").attachArticleMetrics(articleId, {
                articleMetricsView: true
            });
        }
    });

    var figshareWidget = $(".new_figshare_widget");
    if (figshareWidget.length > 0) {
        window.figshare.load("f1000", function(Widget) {
            // Select a tag/tags defined in your page. In this tag we will place the widget.
            _.map(figshareWidget, function(el){
                var widget = new Widget({
                    articleId: $(el).attr("figshare_articleId")
                    //height:300 // this is the height of the viewer part. [Default: 550]
                });
                widget.initialize(); // initialize the widget
                widget.mount(el); // mount it in a tag that's on your page
                // this will save the widget on the global scope for later use from
                // your JS scripts. This line is optional.
                //window.widget = widget;
            });
        });
    }
</script>

<script>
    $(document).ready(function () {

        
        var reportIds = {
                           "69943": 0,
                           "69942": 0,
                           "69945": 0,
                           "69946": 0,
                    };

        $(".referee-response-container,.js-referee-report").each(function(index, el) {
            var reportId = $(el).attr("data-reportid"),
                reportCount = reportIds[reportId] || 0;
            $(el).find(".comments-count-container,.js-referee-report-views").html(reportCount);
        });

        var uuidInput = $("#article_uuid"),
            oldUUId = uuidInput.val(),
            newUUId = "36d3bcd2-c808-41ef-89f5-44005e7019d3";
        uuidInput.val(newUUId);

        $("a[href*='article_uuid=']").each(function(index, el) {
            var newHref = $(el).attr("href").replace(oldUUId, newUUId);
            $(el).attr("href", newHref);
        });

    });
</script>              </div>
        </div>

        
            
            <div class="o-page__footer sticky-email-wrapper">
                
                

                


<footer class="c-footer t-inverted">

    <div class="o-wrapper">
        <div class="o-layout">


                        
            <div class="o-layout__item u-mb--3">
                <div class="c-branding c-branding--research">
                    <img src="/img/research/F1000Research_white.svg" alt="F1000Research">
                </div>
            </div>


                        
            <div class="o-layout__item u-1/3@md u-mb--3">

                <span class="c-hr c-hr--thick c-hr--low u-mb--2"></span>

                <p class="t-h3 u-mt--0 u-mb--0">An innovative open access publishing platform offering rapid publication and open peer review, whilst supporting data deposition and sharing.</p>

            </div>


                        
            <div class="o-layout__item u-2/3@md">

                <span class="c-hr c-hr--thick c-hr--low u-mb--2"></span>

                <div class="o-layout">
                    <nav class="c-footer__nav">

                            <div class="o-layout__item u-3/5@sm u-mb--3">


                                <div class="o-columns o-columns--2">

                                                                            <a href="/browse/articles" class="t-body c-footer__nav-item "      >Browse</a>
                                                                            <a href="/gateways" class="t-body c-footer__nav-item "      >Gateways</a>
                                                                            <a href="/collections" class="t-body c-footer__nav-item "      >Collections</a>
                                                                            <a href="/about" class="t-body c-footer__nav-item "      >How it Works</a>
                                                                            <a href="https://blog.f1000.com/blogs/f1000research/" class="t-body c-footer__nav-item "      >Blog</a>
                                                                            <a href="/contact" class="t-body c-footer__nav-item "      >Contact</a>
                                                                            <a href="/developers" class="t-body c-footer__nav-item u-hide u-show@navbar"      >For Developers</a>
                                                                            <a href="/published/rss" class="t-body c-footer__nav-item "   title="RSS feed of published articles"     >RSS</a>
                                    
                                </div>

                            </div>

                            <div class="o-layout__item u-2/5@sm u-center u-right@sm u-mb--3">

                                <div class="u-hide u-show@lg">
                                    <div class="_mdl-layout">
                                        <a class="mdl-button mdl-js-button mdl-button--inverted mdl-button--no-shadow mdl-js-ripple-effect mdl-button--outline" href="/for-authors/publish-your-research"   data-test-id="footer_submit_research"  >Submit Your Research</a>
                                    </div>
                                </div>

                            </div>

                    </nav>
                </div>

            </div>

            <div class="o-layout__item u-mb--2">
                <div class="c-footer__share">
                        <div class="c-footer__share">
        <span class="c-footer__share-icon" title="Open Access">
            <span class="f1r-icon icon-100_open_access license-icon"></span>
        </span>

        <a class="c-footer__share-icon" href="//creativecommons.org/licenses" target="_blank" title="Creative Commons License CC-BY">
            <span class="f1r-icon icon-116_cc license-icon license-icon-cc"></span>
            <span class="f1r-icon icon-117_ccby license-icon license-icon-cc"></span>
        </a>

        <a class="c-footer__share-icon" href="//creativecommons.org/about/cc0" target="_blank" title="Creative Commons License CC0">
            <span class="f1r-icon icon-118_cco license-icon"></span>
        </a>

    </div>
                </div>
            </div>


                        
            <div class="o-layout__item u-1/3@md u-mb--3">

                <span class="c-hr c-hr--low u-mb--3"></span>

                <p class="c-footer__social u-mt--0 u-mb--0 u-white--low-med">Follow us
                    <a href="https://www.facebook.com/F1000" target="_blank" class="c-footer__social-icon f1r-icon icon-55_footer_facebook"></a>
                    <a href="https://twitter.com/#!/F1000Research" target="_blank" class="c-footer__social-icon f1r-icon icon-56_footer_twitter"></a>
                    <a href="http://www.youtube.com/user/F1000research" target="_blank" class="c-footer__social-icon f1r-icon icon-57_footer_youtube"></a></p>

            </div>


                        
            <div class="o-layout__item u-2/3@md u-right@md">

                <span class="c-hr c-hr--low u-mb--3"></span>

                <p class="t-caption u-white--low-med">&copy; 2012-2020 F1000 Research Ltd. ISSN 2046-1402 | <a href="/about/legal" class="copyrightLegal">Legal</a> | Partner of <a target="_blank" href="http://www.who.int/hinari/en/">HINARI</a>  &bull; <a target="_blank" href="http://crossref.org/">CrossRef</a> &bull; <a target="_blank" href="http://about.orcid.org/">ORCID</a> &bull; <a target="_blank" href="http://www.fairsharing.org">FAIRSharing</a></p>

            </div>
        </div>
    </div>

</footer>            </div>
        
    </div>

            <div class="js-cookie-spacer"></div>
        <div class="cookie-warning">
            <div class="instruction">The F1000Research website uses cookies. By continuing to browse the site, you are agreeing to our use of cookies. <a class="js-scroll-to" href="/about/legal/privacypolicy#use-of-cookies" data-scroll-target="#use-of-cookies">Find out more &raquo;</a></div>
            <div class="close-button"></div>
        </div>
    
    <script>
                    R.templateTests.simpleTemplate = R.template('<p class="$variable.one">$text</p><p class="${variable.two}">$text</p><p class="$!variable.three">$text</p><p class="$!{variable.four}">$text</p><p class="${selector}.five">$text</p>');
            R.templateTests.runTests();
        
        var F1000platform = new F1000.Platform({
            name: "f1000research",
            displayName: "F1000Research",
            hostName: "f1000research.com",
            id: "1",
            editorialEmail: "research@f1000.com",
            infoEmail: "info@f1000.com",
            usePmcStats: true
        });

                    $(function(){R.ui.dropdowns('.dropdown-for-authors, .dropdown-for-about, .dropdown-for-myresearch');});
            // $(function(){R.ui.dropdowns('.dropdown-for-referees');});

            $(document).ready(function () {
                if ($(".cookie-warning").is(":visible")) {
                    $(".sticky").css("margin-bottom", "35px");
                    $(".devices").addClass("devices-and-cookie-warning");
                }
                $(".cookie-warning .close-button").click(function (e) {
                    $(".devices").removeClass("devices-and-cookie-warning");
                    $(".sticky").css("margin-bottom", "0");
                });

                $("#tweeter-feed .tweet-message").each(function (i, message) {
                    var self = $(message);
                    self.html(linkify(self.html()));
                });

                $(".partner").on("mouseenter mouseleave", function() {
                    $(this).find(".gray-scale, .colour").toggleClass("is-hidden");
                });
            });
        
    </script>

            
<div class="sign-in-popup">
	<!-- <a href="#" class="sign-in shadow">Sign in <span class="sign-in-image-active"></span></a> -->
	<a href="#" class="sign-in ${locale}">Sign In <span class="arrow-closed sign-in-arrow-padding arrow-opened"></span></a>
	<div class="sign-in-form">

            <form action="https://f1000research.com/j_spring_oauth_security_check" id="googleOAuth" method="post"  target="_top" >
                                    <input class="target-field" type="hidden" name="target" value="/articles/9-1014.html"/>
                            <input id="google-remember-me" name="_spring_security_oauth_remember_me" type="hidden" value="true"/>
        <input id="system-google" name="system" type="hidden" value="GOOGLE"/>
    </form>
            <form action="https://f1000research.com/j_spring_oauth_security_check" id="facebookOAuth" method="post"  target="_top" >
                                    <input class="target-field" type="hidden" name="target" value="/articles/9-1014.html"/>
                            <input id="facebook-remember-me" name="_spring_security_oauth_remember_me" type="hidden" value="true"/>
        <input id="system-fb" name="system" type="hidden" value="FACEBOOK"/>
    </form>
            <form action="https://f1000research.com/j_spring_oauth_security_check" id="orcidOAuth" method="post"  target="_top" >
                                    <input class="target-field" type="hidden" name="target" value="/articles/9-1014.html"/>
                            <input id="orcid-remember-me" name="_spring_security_oauth_remember_me" type="hidden" value="true"/>
        <input id="system-orcid" name="system" type="hidden" value="ORCID"/>
    </form>
		<form id="sign-in-form" class="login-container" action="https://f1000research.com/login" method="post" name="f">
           <div id="sign-in-form-gfb-popup"></div>

                                                            <input class="target-field" type="hidden" name="target" value="/articles/9-1014.html"/>
                            			<input type="text" name="username" id="signin-email-box" class="sign-in-input" placeholder="Email address" autocomplete="email">
			<input type="password" name="password" id="signin-password-box" class="sign-in-input" placeholder="Password" autocomplete="current-password">
			<div class="sign-in-remember">
                <div class="checkbox-wrapper">
    				<input type="checkbox" id="remember-me" name="remember_me" class="checkbox is-hidden">
                </div>
                <span class="checkbox-label">Remember me</span>
			</div>
			<a href="#" class="sign-in-link" id="forgot-password-link">Forgotten your password?</a>
			<div class="sign-in-button-container margin-top margin-left-20 margin-bottom">
				<button type="submit" id="sign-in-button" class="sign-in-buttons general-white-orange-button">Sign In</button>
				<button type="button" id="sign-in-cancel" class="sign-in-buttons sign-in-cancel-button margin-left">Cancel</button>
				<div class="clearfix"></div>
			</div>
			<div class="sign-in-error">Email or password not correct. Please try again</div>
			<div class="sign-in-loading">Please wait...</div>
		</form>
		<div class="forgot-password-container">
			
<script type="text/javascript">
	$(function(){
		// Note: All the setup needs to run against a name attribute and *not* the id due the clonish
		// nature of facebox...
		$("a[id=googleSignInButton]").click(function(event){
            event.preventDefault();
            $("input[id=oAuthSystem]").val("GOOGLE");
            $("form[id=oAuthForm]").submit();
        });
        $("a[id=facebookSignInButton]").click(function(event){
            event.preventDefault();
            $("input[id=oAuthSystem]").val("FACEBOOK");
            $("form[id=oAuthForm]").submit();
        });
        $("a[id=orcidSignInButton]").click(function(event){
            event.preventDefault();
            $("input[id=oAuthSystem]").val("ORCID");
            $("form[id=oAuthForm]").submit();
        });
	});
</script>

<span class="text first">
	If you've forgotten your password, please enter your email address below and we'll send you instructions on how to reset your password.
    <p>The email address should be the one you originally registered with F1000.</p>
</span>
<input name="email" class="sign-in-input" id="email-forgot-password" type="text" placeholder="Email address">
<div class="forgot-password-email-error">
	Email address not valid, please try again
</div>
<div class="forgot-password-google-email-error">
    <p>You registered with F1000 via Google, so we cannot reset your password.</p>
	<p>To sign in, please click <a href="#" id="googleSignInButton">here</a>.</p>
    <p>If you still need help with your Google account password, please click <a href="https://www.google.com/accounts/recovery">here</a>.</p>
</div>
<div class="forgot-password-facebook-email-error">
    <p>You registered with F1000 via Facebook, so we cannot reset your password.</p>
    <p>To sign in, please click <a href="#" id="facebookSignInButton">here</a>.</p>
	<p>If you still need help with your Facebook account password, please click <a href="https://www.facebook.com/recover/initiate">here</a>.</p>
</div>
<div class="clearfix"></div>
<div class="forgot-password-captcha-error">
	Code not correct, please try again
</div>
<div class="clearfix"></div>
<div class="sign-in-button-container margin-left-20 margin-bottom">
	<button type="button" id="sign-in-reset-password" class="sign-in-buttons general-white-orange-button">Reset password</button>
	<button type="button" id="forgot-password-cancel" class="sign-in-buttons sign-in-cancel-button margin-left">Cancel</button>
	<div class="clearfix"></div>
</div>
<span class="text last">
	<a href="mailto:">Email us</a> for further assistance.
</span>
<form action="https://f1000research.com/j_spring_oauth_security_check" id="oAuthForm" method="post" target="_top">
                        <input class="target-field" type="hidden" name="target" value="/articles/9-1014.html"/>
                <input id="oAuthSystem" name="system" type="hidden"/>
</form>
			<div class="forgot-password-server-error">Server error, please try again.</div>
			<div class="sign-in-success">
                <p>We have sent an email to <span id="email-value"></span>, please follow the instructions to reset your password.</p>
                <p>If you don't receive this email, please check your spam filters and/or contact .</p>
            </div>
			<div class="sign-in-loading">Please wait...</div>
		</div>

		<div class="sign-in-form-register-section">
			<div class="sign-in-button-container margin-left-20 margin-bottom">
				<a href="/register" title="Register"><button type="button" id="sign-in-register-button" class="sign-in-buttons general-white-orange-button">Register</button></a>
				<div class="clearfix"></div>
			</div>
		</div>

	</div>
</div>

<script type="text/javascript">
$(document).ready(function () {

    signIn.createSignInAsRow($("#sign-in-form-gfb-popup"));

    $(".target-field").each(function () {
        var uris = $(this).val().split("/");
        if (uris.pop() === "login") {
        	$(this).val(uris.toString().replace(",","/"));
        }
    });
});
</script>
        <div id="templateOverlay" class="is-hidden" hidden="hidden">
  <div class="o-overlay js-overlay is-hidden" hidden="hidden"></div>
</div>

<div id="templateExternalMessages" class="is-hidden" hidden="hidden">
  <div class="o-modal o-modal--auto@md js-external-messages is-hidden" hidden="hidden">
    <div class="o-modal__body">
      <section class="c-console">
        <div class="_mdl-layout c-console__bdy js-external-messages-body"></div>
        <footer class="_mdl-layout c-console__ftr o-flex o-flex--reverse js-external-messages-footer">
          <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored c-console__btn js-external-messages-close" data-action="maintenance-close">I Understand</button>
        </footer>
      </section>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.min.js"></script>

<script src="/js/namespace.js"></script>
<script src="/js/constants.js"></script>
<script src="/js/utilities.js"></script>

<script>
                  F1000.ExtenalMaintenanceItems = [
    {
      start: '2018-12-10T14:21:00Z',
      end: '2018-12-13T16:00:00Z',
      msg: 'This site will be down for a short time on XX December. It is advisable not to start any submissions on that day or you may lose your work unless you save regularly.',
      cookieName: 'outage23122018',
      editor: false,
    }
  ];
</script>

<script src="/js/shared_scripts/cookie-helper.js"></script>
<script src="/js/shared_scripts/mdl-helper.js"></script>

<script src="/js/app/external-maintenance.js"></script>

                <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-5646075-11', 'auto');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
        
                <script type="text/javascript" src="/js/app/research.analytics.js"></script>

        <!-- Start of HubSpot Embed Code -->
        <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4475190.js"></script>
        <!-- End of HubSpot Embed Code -->
    
            <script src="https://my.hellobar.com/4e0495c6f18cbd68731a1dc1978195a144e767ba.js" type="text/javascript" charset="utf-8" async="async"></script>
    </body>

</html>