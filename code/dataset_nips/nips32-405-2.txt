Training both the templates and the deformations of a registration procedure end-to-end is novel and very useful. The loss function has been thoroughly explained.  The explanation for the deformation prior p(V) could be more clearly motivated. It is not clear to me how deformations at different scales are weighted. For example in the case of fMRI registration, I would expect pretty much all images to be rotated and translated as a whole (which should not be given a strong loss), but also locally (which would incur a larger loss). It is not clear to me how these different transformation penalties would be controlled. Perhaps this is regulated by the lambda parameters, but I could not deduce it from the text.  I would like to see some more in-between steps of the model. For example, it would be nice to see velocity maps.  There is no promise in the paper that source code will be released. It would be helpful if the authors clarified that.  Update: I thank the authors for clarifying code release and the whole-image registration step; I'm looking forward to the additional figures to be shown in the supplement. I do not see any additional concerns after the review phase. I still think this is a good paper.