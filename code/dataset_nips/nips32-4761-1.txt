I really enjoyed reading this paper - it is well motivated and the theory is also well described in my opinion.  Originality: The combination of merging a rule-based approach with a neural approach appears to be very well suited for the problem at hand. It has to the best of my knowledge not been studied using graphical models, exploiting the compositional structure of these rules, which is a significant step forward. The compositionality of the rules has been studied in a purely symbolic way by Segler et al in https://onlinelibrary.wiley.com/doi/abs/10.1002/chem.201604556 which I would suggest to additionally cite.  Approaching the problem by decomposing the the rule application into several matching and reaction scoring steps is very elegant.  Do the authors think the choice of the graph neural network for the encoding plays a large role?  ___________ EDIT after authors response: I want to thank the authors for addressing the questions. With the additional data provided during the rebuttal (which should be added to the final version), I raise my score accordingly.