The authors deal with a new problem that extends existing problems in a natural way, and present new solutions that extend existing solutions in a natural way; thus in some ways the paper is not very original, but it must be noted that the problem #opt has some surprising properties that make the whole endeavor quite interesting.  As for the contribution, it is a valuable piece with new algorithms that have good performance. I really take issue with the emphasis on semirings; I cannot see how this helps the whole effort. Are semirings bringing new insights here? Or are they just more general so that the algorithm applies to other problems?  Why does it make a difference to state results this way?  Concerning the significance, the results do address and solve a new problem, but I think the authors should perhaps work a bit harder in explaining why this problem is significant in practice. This is a point that is left a bit weak.  Concerning the text: - Instead of "[6] introduced...", better "Ref. [6] introduced..." (and similar expressions). - The fonts for Algorithm 1/2 are **very** small... please increase them. - Also Figure 3 is really too small.  - Page 7, line 300: "were [by] guided by". - References: "fortran" should be "Fortran". 